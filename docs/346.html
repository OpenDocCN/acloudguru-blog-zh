<html>
<head>
<title>Which S3 Storage Class is right for you? | A Cloud Guru</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>哪种S3储物类适合您？|云专家</h1>
<blockquote>原文：<a href="https://acloudguru.com/blog/engineering/s3-glacier-instant-retrieval-deep-dive-which-s3-storage-class-is-right-for-me#0001-01-01">https://acloudguru.com/blog/engineering/s3-glacier-instant-retrieval-deep-dive-which-s3-storage-class-is-right-for-me#0001-01-01</a></blockquote><div><div class="elementor-widget-container"><p>在本帖中，我们将接触S3冰川即时检索，看看这个新的AWS存储类能帮你节省多少。此外，我们还提供信息图，帮助您确定哪种S3存储产品最适合您的需求。</p><p>AWS re:Invent 2021 带来了一大堆消息，但其中一个很容易被错过的是<a href="https://aws.amazon.com/blogs/aws/amazon-s3-glacier-is-the-best-place-to-archive-your-data-introducing-the-s3-glacier-instant-retrieval-storage-class/" target="_blank" rel="noreferrer noopener">新的亚马逊S3冰川即时检索存储类</a>。</p><h3>其他AWS re:Invent 2021亮点</h3><hr class="wp-block-separator"/><h2 class="has-text-align-center" id="h-accelerate-your-career">加速您的职业发展</h2><p class="has-text-align-center"><a href="https://acloudguru.com/pricing">从ACG开始</a>通过AWS、Microsoft Azure、Google Cloud等领域的课程和实际动手实验室改变你的职业生涯。</p><hr class="wp-block-separator"/><p>“我们现在不需要它，可能几年后也不会需要。但是当我们需要它的时候，我们会需要它<em>现在</em>是存储的一个常见用户故事。</p><p>多年来，AWS为我们提供了许多选择，尤其是S3，但对即时访问的需求使冰川及其低成本成为许多公司无法企及的。</p><p>S3冰川即时检索旨在为您提供两全其美的解决方案，即低成本和同步即时访问。但是，这是适合您的S3存储课程吗？</p><h2>试驾S3冰川即时检索</h2><p>首先，让我们看看S3冰川即时检索到底有多“即时”。</p><p>我们将首先在全球几个不同的地区创建一些新的S3存储桶，移除它们的公共访问阻止，并确认它们已准备就绪:</p><p>现在让我们制作一个随机文件，并向每个桶上传两个版本；一个使用S3标准，一个使用新的S3冰川即时检索，同时将文件的ACL设置为Public。</p><p>有趣的是，<code>aws s3 cp</code>并不支持新的存储类；只有<code>aws s3api put-object</code>做到了；不确定是疏忽还是故意。如果<code>put-object</code>对你不起作用，你可能需要更新你的AWS命令行界面。</p><p>由于我们正在处理一项新功能，让我们在AWS控制台中仔细检查一下，以确保新的存储类按预期应用:</p><figure class="wp-block-image size-full"><img loading="lazy" src="../Images/6ac9f22de012854c5064bfb0b90fd967.png" alt="" class="wp-image-95359" srcset="https://res.cloudinary.com/acloud-guru/image/fetch/c_thumb,f_auto,q_auto,w_947/https://acg-wordpress-content-production.s3.us-west-2.amazonaws.com/app/uploads/2021/12/S3-Glacier-Instant-Retrieval-3.png 947w, https://res.cloudinary.com/acloud-guru/image/fetch/c_thumb,f_auto,q_auto,w_300/https://acg-wordpress-content-production.s3.us-west-2.amazonaws.com/app/uploads/2021/12/S3-Glacier-Instant-Retrieval-3.png 300w, https://res.cloudinary.com/acloud-guru/image/fetch/c_thumb,f_auto,q_auto,w_768/https://acg-wordpress-content-production.s3.us-west-2.amazonaws.com/app/uploads/2021/12/S3-Glacier-Instant-Retrieval-3.png 768w, https://res.cloudinary.com/acloud-guru/image/fetch/c_thumb,f_auto,q_auto,w_380/https://acg-wordpress-content-production.s3.us-west-2.amazonaws.com/app/uploads/2021/12/S3-Glacier-Instant-Retrieval-3.png 380w" sizes="(max-width: 947px) 100vw, 947px" data-original-src="https://res.cloudinary.com/acloud-guru/image/fetch/c_thumb,f_auto,q_auto/https://acg-wordpress-content-production.s3.us-west-2.amazonaws.com/app/uploads/2021/12/S3-Glacier-Instant-Retrieval-3.png"/></figure><p>现在我们已经将文件放入桶中，让我们使用<code>curl</code>将它们拉回来，并获得每次传输的总响应时间。</p><figure class="wp-block-image size-full"><img loading="lazy" src="../Images/38a40f88deb0d5261953ad27b1a6a999.png" alt="" class="wp-image-95360" srcset="https://res.cloudinary.com/acloud-guru/image/fetch/c_thumb,f_auto,q_auto,w_979/https://acg-wordpress-content-production.s3.us-west-2.amazonaws.com/app/uploads/2021/12/S3-Glacier-Instant-Retrieval-4.png 979w, https://res.cloudinary.com/acloud-guru/image/fetch/c_thumb,f_auto,q_auto,w_300/https://acg-wordpress-content-production.s3.us-west-2.amazonaws.com/app/uploads/2021/12/S3-Glacier-Instant-Retrieval-4.png 300w, https://res.cloudinary.com/acloud-guru/image/fetch/c_thumb,f_auto,q_auto,w_768/https://acg-wordpress-content-production.s3.us-west-2.amazonaws.com/app/uploads/2021/12/S3-Glacier-Instant-Retrieval-4.png 768w, https://res.cloudinary.com/acloud-guru/image/fetch/c_thumb,f_auto,q_auto,w_380/https://acg-wordpress-content-production.s3.us-west-2.amazonaws.com/app/uploads/2021/12/S3-Glacier-Instant-Retrieval-4.png 380w" sizes="(max-width: 979px) 100vw, 979px" data-original-src="https://res.cloudinary.com/acloud-guru/image/fetch/c_thumb,f_auto,q_auto/https://acg-wordpress-content-production.s3.us-west-2.amazonaws.com/app/uploads/2021/12/S3-Glacier-Instant-Retrieval-4.png"/></figure><p>好的，看起来不错！由于我到不同地区的距离和正常(澳大利亚)互联网的可变性，一些结果有点不同，但它们都在同一范围内。</p><p>关于为什么ap-southeast-2特别快，这是由于我在澳大利亚的位置，这使我尽可能地靠近这个地区(至少在明年<a href="https://www.allthingsdistributed.com/2020/12/aws-announces-second-australia-region.html" target="_blank" rel="noreferrer noopener"> AWS推出墨尔本地区</a>之前)。</p><h2>利用<meta charset="utf-8"/> S3冰川即时检索节省成本</h2><p>使用S3冰川即时检索是否省钱取决于你打算如何使用它。</p><p>让我们做一些成本建模(哦，令人兴奋！)完全基于存储和检索成本，看看看起来如何。无论存储类别如何，数据传输等其他成本都是相同的。我们将使用截至2021年12月美国东部1区的<a href="https://aws.amazon.com/s3/pricing/?nc=sn&amp;loc=4" target="_blank" rel="noreferrer noopener"> S3价格</a>。</p><p>首先，让我们纯粹看一下存储成本，看看零数据传输是什么样子。我们将与其他一些<a href="https://aws.amazon.com/s3/storage-classes/" target="_blank" rel="noreferrer noopener"> S3存储类别</a>进行比较:S3标准、S3标准-IA和S3冰川深层档案，以供参考:</p><figure class="wp-block-image size-large"><img loading="lazy" src="../Images/4ff79cbd7189b57438d83c365df7eb1e.png" alt="" class="wp-image-95736" srcset="https://res.cloudinary.com/acloud-guru/image/fetch/c_thumb,f_auto,q_auto,w_5197/https://acg-wordpress-content-production.s3.us-west-2.amazonaws.com/app/uploads/2021/12/Picture1.png 5197w, https://res.cloudinary.com/acloud-guru/image/fetch/c_thumb,f_auto,q_auto,w_300/https://acg-wordpress-content-production.s3.us-west-2.amazonaws.com/app/uploads/2021/12/Picture1.png 300w, https://res.cloudinary.com/acloud-guru/image/fetch/c_thumb,f_auto,q_auto,w_1024/https://acg-wordpress-content-production.s3.us-west-2.amazonaws.com/app/uploads/2021/12/Picture1.png 1024w, https://res.cloudinary.com/acloud-guru/image/fetch/c_thumb,f_auto,q_auto,w_768/https://acg-wordpress-content-production.s3.us-west-2.amazonaws.com/app/uploads/2021/12/Picture1.png 768w, https://res.cloudinary.com/acloud-guru/image/fetch/c_thumb,f_auto,q_auto,w_1536/https://acg-wordpress-content-production.s3.us-west-2.amazonaws.com/app/uploads/2021/12/Picture1.png 1536w, https://res.cloudinary.com/acloud-guru/image/fetch/c_thumb,f_auto,q_auto,w_2048/https://acg-wordpress-content-production.s3.us-west-2.amazonaws.com/app/uploads/2021/12/Picture1.png 2048w, https://res.cloudinary.com/acloud-guru/image/fetch/c_thumb,f_auto,q_auto,w_380/https://acg-wordpress-content-production.s3.us-west-2.amazonaws.com/app/uploads/2021/12/Picture1.png 380w" sizes="(max-width: 5197px) 100vw, 5197px" data-original-src="https://res.cloudinary.com/acloud-guru/image/fetch/c_thumb,f_auto,q_auto/https://acg-wordpress-content-production.s3.us-west-2.amazonaws.com/app/uploads/2021/12/Picture1.png"/></figure><p>不出所料，Deep Archive仍然是最便宜的，而Standard是最贵的。但Standard-IA和Glacier Instant Retrieval之间的差异相当显著，成本降低了68%，正如<a href="https://aws.amazon.com/about-aws/whats-new/2021/11/amazon-s3-glacier-instant-retrieval-storage-class/" target="_blank" rel="noreferrer noopener">官方公告宣称的</a>。</p><p>但魔鬼在细节，这里的细节是检索成本。</p><p>让我们看一下，如果我们在一年中只检索100TB的1%(分为每天2，875个1MB文件),比较Standard-IA和Glacier即时存取检索，会是什么情况:</p><figure class="wp-block-image size-large"><img loading="lazy" src="../Images/80380ef29514d69cc782a8eda14cfdd1.png" alt="" class="wp-image-95737" srcset="https://res.cloudinary.com/acloud-guru/image/fetch/c_thumb,f_auto,q_auto,w_5198/https://acg-wordpress-content-production.s3.us-west-2.amazonaws.com/app/uploads/2021/12/Picture2.png 5198w, https://res.cloudinary.com/acloud-guru/image/fetch/c_thumb,f_auto,q_auto,w_300/https://acg-wordpress-content-production.s3.us-west-2.amazonaws.com/app/uploads/2021/12/Picture2.png 300w, https://res.cloudinary.com/acloud-guru/image/fetch/c_thumb,f_auto,q_auto,w_1024/https://acg-wordpress-content-production.s3.us-west-2.amazonaws.com/app/uploads/2021/12/Picture2.png 1024w, https://res.cloudinary.com/acloud-guru/image/fetch/c_thumb,f_auto,q_auto,w_768/https://acg-wordpress-content-production.s3.us-west-2.amazonaws.com/app/uploads/2021/12/Picture2.png 768w, https://res.cloudinary.com/acloud-guru/image/fetch/c_thumb,f_auto,q_auto,w_1536/https://acg-wordpress-content-production.s3.us-west-2.amazonaws.com/app/uploads/2021/12/Picture2.png 1536w, https://res.cloudinary.com/acloud-guru/image/fetch/c_thumb,f_auto,q_auto,w_2048/https://acg-wordpress-content-production.s3.us-west-2.amazonaws.com/app/uploads/2021/12/Picture2.png 2048w, https://res.cloudinary.com/acloud-guru/image/fetch/c_thumb,f_auto,q_auto,w_380/https://acg-wordpress-content-production.s3.us-west-2.amazonaws.com/app/uploads/2021/12/Picture2.png 380w" sizes="(max-width: 5198px) 100vw, 5198px" data-original-src="https://res.cloudinary.com/acloud-guru/image/fetch/c_thumb,f_auto,q_auto/https://acg-wordpress-content-production.s3.us-west-2.amazonaws.com/app/uploads/2021/12/Picture2.png"/></figure><p>信不信由你，即使在一年的时间里从我们的桶中取出1TB也不会改变Standard-IA那么多(事实上只有0.03%)。另一方面，冰川即时存取检索显示了显著的差异(54.7%)。</p><p>Glacier Instant Retrieval的检索成本比Standard-IA贵得多，特别是因为它是为存档目的而设计的。事实上，每GB的检索成本是这个价格的三倍，而GET请求要贵出惊人的10倍。</p><p>但即使在这里，下载量这么大，我们还是比Standard-IA便宜30%！这是不容忽视的。</p><p>您正在检索的文件类型也很重要。在我们的上一个场景中，我们每天使用5250个1MB的文件；普通文档或PDF的大小。但是在另一种情况下，我们假设每天有5个1GB大小的文件；中等媒体项目的规模。在我们的100TB存储桶中，这两项合计约为每年1.8TB。</p><p>我们将这两个与Standard-IA进行比较:</p><figure class="wp-block-image size-large"><img loading="lazy" src="../Images/d5fb4ce554b20ec1b86bc6683ddb7a51.png" alt="" class="wp-image-95738" srcset="https://res.cloudinary.com/acloud-guru/image/fetch/c_thumb,f_auto,q_auto,w_5197/https://acg-wordpress-content-production.s3.us-west-2.amazonaws.com/app/uploads/2021/12/Picture3.png 5197w, https://res.cloudinary.com/acloud-guru/image/fetch/c_thumb,f_auto,q_auto,w_300/https://acg-wordpress-content-production.s3.us-west-2.amazonaws.com/app/uploads/2021/12/Picture3.png 300w, https://res.cloudinary.com/acloud-guru/image/fetch/c_thumb,f_auto,q_auto,w_1024/https://acg-wordpress-content-production.s3.us-west-2.amazonaws.com/app/uploads/2021/12/Picture3.png 1024w, https://res.cloudinary.com/acloud-guru/image/fetch/c_thumb,f_auto,q_auto,w_768/https://acg-wordpress-content-production.s3.us-west-2.amazonaws.com/app/uploads/2021/12/Picture3.png 768w, https://res.cloudinary.com/acloud-guru/image/fetch/c_thumb,f_auto,q_auto,w_1536/https://acg-wordpress-content-production.s3.us-west-2.amazonaws.com/app/uploads/2021/12/Picture3.png 1536w, https://res.cloudinary.com/acloud-guru/image/fetch/c_thumb,f_auto,q_auto,w_2048/https://acg-wordpress-content-production.s3.us-west-2.amazonaws.com/app/uploads/2021/12/Picture3.png 2048w, https://res.cloudinary.com/acloud-guru/image/fetch/c_thumb,f_auto,q_auto,w_380/https://acg-wordpress-content-production.s3.us-west-2.amazonaws.com/app/uploads/2021/12/Picture3.png 380w" sizes="(max-width: 5197px) 100vw, 5197px" data-original-src="https://res.cloudinary.com/acloud-guru/image/fetch/c_thumb,f_auto,q_auto/https://acg-wordpress-content-production.s3.us-west-2.amazonaws.com/app/uploads/2021/12/Picture3.png"/></figure><p>相比之下，Glacier Instant的检索成本随着大文件数量的减少而增加。对于这里相同的总传输大小，有近20%的差异。我们还可以看到Glacier即时访问实际上变得比标准的非频繁访问更加昂贵。</p><p>再次:S3冰川即时检索是一个<strong>档案</strong>；文件不应该用于访问，但需要在需要时快速可用。当物品保持原样时，我们的成本节约是惊人的。</p><p>与此同时，S3冰川深层档案馆继续保持其一贯的惊人的便宜，只要你能承受检索的延迟，比任何其他解决方案都便宜90%以上。</p><figure class="wp-block-image size-large"><img loading="lazy" src="../Images/dd4fa1f2a3114539e63d94ac5b630947.png" alt="" class="wp-image-95739" srcset="https://res.cloudinary.com/acloud-guru/image/fetch/c_thumb,f_auto,q_auto,w_5197/https://acg-wordpress-content-production.s3.us-west-2.amazonaws.com/app/uploads/2021/12/Picture4.png 5197w, https://res.cloudinary.com/acloud-guru/image/fetch/c_thumb,f_auto,q_auto,w_300/https://acg-wordpress-content-production.s3.us-west-2.amazonaws.com/app/uploads/2021/12/Picture4.png 300w, https://res.cloudinary.com/acloud-guru/image/fetch/c_thumb,f_auto,q_auto,w_1024/https://acg-wordpress-content-production.s3.us-west-2.amazonaws.com/app/uploads/2021/12/Picture4.png 1024w, https://res.cloudinary.com/acloud-guru/image/fetch/c_thumb,f_auto,q_auto,w_768/https://acg-wordpress-content-production.s3.us-west-2.amazonaws.com/app/uploads/2021/12/Picture4.png 768w, https://res.cloudinary.com/acloud-guru/image/fetch/c_thumb,f_auto,q_auto,w_1536/https://acg-wordpress-content-production.s3.us-west-2.amazonaws.com/app/uploads/2021/12/Picture4.png 1536w, https://res.cloudinary.com/acloud-guru/image/fetch/c_thumb,f_auto,q_auto,w_2048/https://acg-wordpress-content-production.s3.us-west-2.amazonaws.com/app/uploads/2021/12/Picture4.png 2048w, https://res.cloudinary.com/acloud-guru/image/fetch/c_thumb,f_auto,q_auto,w_380/https://acg-wordpress-content-production.s3.us-west-2.amazonaws.com/app/uploads/2021/12/Picture4.png 380w" sizes="(max-width: 5197px) 100vw, 5197px" data-original-src="https://res.cloudinary.com/acloud-guru/image/fetch/c_thumb,f_auto,q_auto/https://acg-wordpress-content-production.s3.us-west-2.amazonaws.com/app/uploads/2021/12/Picture4.png"/></figure><p>我们应得的英雄。</p><h2>我的用例呢？</h2><p>这是最古老的规则:<strong>了解你的业务需求</strong>。</p><p>如果您有出于业务原因需要保留的对象，并且绝对需要立即访问，S3冰川即时检索可以完全满足您的需求。</p><p>如果它可以等待甚至几分钟，S3冰川灵活检索(以前只是S3冰川)可以继续为您节省堆，甚至更多，如果几个小时或几天是一个选项，在那里你可以使用S3冰川深度档案。</p><p>但是，有时我们不知道实际的业务需求是什么，因为业务可能不知道。对于这些情况，我们有S3智能分层</p><h2>S3智能分层</h2><p>AWS可能比你更了解你的数据使用模式。我们可以利用这一点，通过<a href="https://aws.amazon.com/s3/storage-classes/intelligent-tiering/" target="_blank" rel="noreferrer noopener"> S3智能分层</a>让我们的生活变得更加轻松。</p><p>这不是新功能，我就不深究了。但在这种情况下，当我们试图找到使用不同存储类别(如Standard-IA或Glacier Instant Retrieval)之间的界限时，我们可以让AWS为我们管理这一点。</p><p>如果您不太确定您的数据是否属于Glacier即时检索，智能分层可以让您不再头疼。虽然您确实为这种便利支付了少量费用(每1，000个对象0.0025美元)，但这很容易被将文件放在最佳存储类别中所节省的成本抵消。</p><h2>信息图:哪个S3存储班适合我？</h2><p>毫无疑问，S3冰川即时检索可以并将为许多企业节省大量资金。这确实给使用哪些存储类的问题增加了一些新的复杂性。因此，这里有一个方便的信息图表来帮助指导这一过程。(编辑:感谢推特上的詹姆斯·瓦桑森指出原文中的一个错误！)</p><figure class="wp-block-image size-full"><img loading="lazy" src="../Images/95dac1e40f97daca5c1d6ffebb94978d.png" alt="" class="wp-image-95740" srcset="https://res.cloudinary.com/acloud-guru/image/fetch/c_thumb,f_auto,q_auto,w_965/https://acg-wordpress-content-production.s3.us-west-2.amazonaws.com/app/uploads/2021/12/Which-S3-Storage-Class-is-right-for-me-Infograhic.png 965w, https://res.cloudinary.com/acloud-guru/image/fetch/c_thumb,f_auto,q_auto,w_300/https://acg-wordpress-content-production.s3.us-west-2.amazonaws.com/app/uploads/2021/12/Which-S3-Storage-Class-is-right-for-me-Infograhic.png 300w, https://res.cloudinary.com/acloud-guru/image/fetch/c_thumb,f_auto,q_auto,w_768/https://acg-wordpress-content-production.s3.us-west-2.amazonaws.com/app/uploads/2021/12/Which-S3-Storage-Class-is-right-for-me-Infograhic.png 768w, https://res.cloudinary.com/acloud-guru/image/fetch/c_thumb,f_auto,q_auto,w_380/https://acg-wordpress-content-production.s3.us-west-2.amazonaws.com/app/uploads/2021/12/Which-S3-Storage-Class-is-right-for-me-Infograhic.png 380w" sizes="(max-width: 965px) 100vw, 965px" data-original-src="https://res.cloudinary.com/acloud-guru/image/fetch/c_thumb,f_auto,q_auto/https://acg-wordpress-content-production.s3.us-west-2.amazonaws.com/app/uploads/2021/12/Which-S3-Storage-Class-is-right-for-me-Infograhic.png"/></figure><p>阻碍S3冰川的一个因素是对异步请求的恐惧，以及这对我们的应用程序意味着什么。S3冰川即时检索使用与S3标准和标准IA相同的同步API，无需应用程序重构。</p><p>对于合规案例，这是显而易见的。但是，对于拥有数TB数据的组织来说，这也是非常好的选择，因为他们相信人们不会访问这些数据，但是企业宣称“任何东西都必须随时可以访问”，同时比使用Standard-IA节省更多成本。</p><p>这是一个很好解决的问题。</p><hr class="wp-block-separator"/><h2 class="has-text-align-center">保持在云的顶端</h2><p class="has-text-align-center"><em>在<a href="https://twitter.com/acloudguru" target="_blank" rel="noreferrer noopener"> Twitter上关注ACG</a>和<a href="https://www.facebook.com/acloudguru" target="_blank" rel="noreferrer noopener">脸书</a>，在<a href="https://www.youtube.com/c/AcloudGuru/?sub_confirmation=1" target="_blank" rel="noreferrer noopener">YouTube上订阅一个云专家</a>来获取你能处理的所有云更新！此外，加入我们令人敬畏的<a href="https://discord.com/invite/acloudguru" target="_blank" rel="noreferrer noopener"> Discord社区</a>，与训练有素的架构师和其他志同道合的阴云密布的人进行数字交流。</em></p></div></div>    
</body>
</html>