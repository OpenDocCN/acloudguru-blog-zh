<html>
<head>
<title>#CloudGuruChallenge - Event-Driven Python on AWS | A Cloud Guru</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1># CloudGuruChallenge-AWS上的事件驱动Python |云专家</h1>
<blockquote>原文：<a href="https://acloudguru.com/blog/engineering/cloudguruchallenge-python-aws-etl#0001-01-01">https://acloudguru.com/blog/engineering/cloudguruchallenge-python-aws-etl#0001-01-01</a></blockquote><div><div class="elementor-widget-container"><h3 id="h-challenge-steps">挑战步骤</h3><p>你需要安装<a href="https://www.python.org/downloads/"> Python3 </a>并访问AWS环境。 <em>查看<a href="https://read.acloud.guru/my-python-setup-77c57a2fc4b6">这篇来自AWS英雄Ben Kehoe的文章</a>，了解如何建立一个健康的Python开发环境。</em></p><figure class="wp-block-image size-large"><img loading="lazy" src="../Images/6c739282d3587ccb06672cc4b2746fce.png" alt="Flowchart of an example ETL job" class="wp-image-39835" srcset="https://res.cloudinary.com/acloud-guru/image/fetch/c_thumb,f_auto,q_auto,w_1024/https://acg-wordpress-content-production.s3.us-west-2.amazonaws.com/app/uploads/2020/09/ETL.png 1024w, https://res.cloudinary.com/acloud-guru/image/fetch/c_thumb,f_auto,q_auto,w_300/https://acg-wordpress-content-production.s3.us-west-2.amazonaws.com/app/uploads/2020/09/ETL.png 300w, https://res.cloudinary.com/acloud-guru/image/fetch/c_thumb,f_auto,q_auto,w_768/https://acg-wordpress-content-production.s3.us-west-2.amazonaws.com/app/uploads/2020/09/ETL.png 768w, https://res.cloudinary.com/acloud-guru/image/fetch/c_thumb,f_auto,q_auto,w_1509/https://acg-wordpress-content-production.s3.us-west-2.amazonaws.com/app/uploads/2020/09/ETL.png 1509w" sizes="(max-width: 1024px) 100vw, 1024px" data-original-src="https://acloudguru.com//app/uploads/2020/09/ETL-1024x460.png?x64535"/></figure><ol><li><strong> ETL工作。</strong>创建一个按每日计划运行的Python计算作业。你可以通过创建一个Python Lambda函数来实现，然后<a href="https://docs.aws.amazon.com/AmazonCloudWatch/latest/events/RunLambdaSchedule.html">从每天一次的CloudWatch规则</a>中触发它。或者，您可以创建一个s <a href="https://docs.aws.amazon.com/AmazonECS/latest/userguide/scheduled_tasks.html">调度的Fargate任务</a>，或者使用AWS Glue 查看<a href="https://docs.aws.amazon.com/glue/latest/dg/monitor-data-warehouse-schedule.html">调度任务。唯一的要求是底层计算必须每天触发一次，而不是在持续轮询的服务器上。</a></li><li><strong>提取。</strong>在你的Python代码中，从Github下载<a href="https://github.com/nytimes/covid-19-data/blob/master/us.csv">这个CSV文件</a>。(这是来自《纽约时报》维护的存储库的美国新冠肺炎数据的每日转储。每天，该文件都会更新一行额外的数据。)将数据加载到内存中的对象中。</li><li><strong>转型。</strong>用Python代码执行数据操作。<ul><li><strong>清理</strong>–日期字段应该转换成日期对象，而不是字符串。</li><li><strong>加入</strong>–我们希望显示恢复的病例以及确诊病例和死亡病例。NYT的数据不跟踪恢复，所以你需要从这个约翰霍普金斯数据集的<a href="https://raw.githubusercontent.com/datasets/covid-19/master/data/time-series-19-covid-combined.csv">中提取我们的恢复数据，并将其合并到你每天的记录中。<em>注:约翰·霍普金斯数据集的病例数和死亡数与NYT的数据不一致。我们将把NYT的数据视为权威数据，并且只复制来自约翰霍普金斯大学的恢复数据。)</em></a></li><li><strong>过滤</strong>–从约翰霍普金斯数据集中删除非美国数据。删除两个数据集中不存在的任何日期。(有一个逐个关闭的问题。)</li></ul></li><li><strong>代码清理。</strong>将你的数据操作工作抽象成一个<a href="https://www.learnpython.org/en/Modules_and_Packages"> Python模块</a>。这个模块应该只执行转换。它不应该关心CSV文件存储在哪里，并且在下一步中不应该知道任何关于数据库的信息。</li><li><strong>加载。</strong>现在，编写代码将转换后的数据加载到数据库中。出于本练习的目的，您可以使用您选择的任何数据库。我建议使用DynamoDB搭配boto3或者RDS Postgres搭配pyscopg。无论哪种方式，您都希望表中的每条记录都包含疫情一天的日期、美国病例数、死亡人数和恢复情况。</li><li><strong>通知。</strong>当数据库更新后，您的代码应该触发一条SNS消息，通知任何感兴趣的用户ETL作业已经完成。该消息应该包括数据库中更新的行数。</li><li><strong>错误处理。</strong>您的代码应该能够处理这些常见的控制流情况:<ol><li>初始加载与更新-您应该能够在作业首次运行时将整个历史数据集加载到数据库中，然后仅使用最近一天的数据进行更新。</li><li>如果数据包含意外或格式错误的输入，您的代码应该会正常失败，并通过SNS报告一条错误消息。下次您的作业运行时，它应该记得它没有成功处理以前的数据，并在继续处理更新的数据之前重试。</li></ol></li><li><strong>测试。</strong>为了确保您的代码能够处理意外情况，请对您的代码进行单元测试，用无效数据替换新冠肺炎CSV文件，并确认您的代码能够正确响应。</li><li><strong> IaC。</strong>确保您的基础设施(Lambda函数、CloudWatch规则、SNS触发器、数据库等)在代码(CloudFormation、Terraform或类似代码)中定义</li><li><strong>源码控制。</strong>将你的代码和配置存储在源代码控制中(GitHub，或者类似的)</li><li><strong>仪表板。</strong>没有报告的ETL流程会是什么样的？看看你能否<a href="https://docs.aws.amazon.com/quicksight/latest/user/enabling-access-rds.html">将你的数据库连接到AWS Quicksight </a>或其他BI服务，如Tableau，以生成一段时间内美国病例数、死亡率和恢复情况的可视化。</li><li><strong>博文。</strong>(非常重要)写一篇简短的博文，解释你的收获和应对挑战的方法。链接到您的数据可视化，以便我们可以尝试一下！如果你没有自己的博客，<a href="https://hashnode.com/"> Hashnode </a>或<a href="https://dev.to"> dev.to </a>是一个很好的起点。</li></ol><hr class="wp-block-separator"/><p class="has-text-align-center"><em>有兴趣升级或开始您的云开发之旅吗？云专家的<a href="https://acloudguru.com/learning-paths/aws-developer"> AWS开发者学习路径</a>提供适合初学者和高级专家的定制课程！</em></p><hr class="wp-block-separator"/><h3 id="h-when-you-re-done">当你完成的时候</h3><p>你可以自己或与他人合作完成项目要求。欢迎在论坛或社交媒体上使用#CloudGuruChallenge标签提问<a href="https://acloud.guru/forums/cloud-guru-challenge/recent?p=1">！</a></p><p>当你完成项目的所有步骤后，在指定的<a href="https://acloud.guru/forums/cloud-guru-challenge/recent?p=1">论坛</a>主题中发布你的博客文章的链接。<strong>然后我将能够在LinkedIn上为你在这个项目中展示的技能背书:Python、事件驱动编程和AWS。</strong>(你还将有机会赢得一些超酷的奖品！)</p><p>最重要的是，#CloudGuruChallenge是免费的，每个人都可以使用；你所需要的就是<a href="https://acloudguru.com/pricing">一个ACG免费会员</a>来发表你的论坛帖子。</p><h3 id="h-resources">资源</h3><p>准备好做一些谷歌搜索，但是如果你是ACG会员，这里有一些资源可以帮助你更好地使用Python和事件驱动编程:</p><p><a href="https://acloud.guru/learn/df3778be-ba58-4be7-a232-aa658bed7517">Python开发简介</a> (16小时课程)</p><p><a href="https://acloud.guru/learn/a0abe7d4-ce82-4dfe-beb9-21d98f4c6941?_ga=2.70420368.1665217949.1599591206-415638573.1596472192">使用Python进行数据管理和报告</a> (6小时课程)</p><p><a href="https://acloud.guru/learn/871c7714-6ba7-46f9-9458-b60c779e5a18?_ga=2.58421034.1665217949.1599591206-415638573.1596472192">在AWS上构建全栈无服务器应用</a> (8小时课程)</p><p>你不需要执行这些额外的步骤来“宣布胜利”,但它们将帮助你的项目脱颖而出，并提供令人敬畏的额外学习。</p><ol><li>使用GitHub Actions、AWS CodePipeline或类似的服务为您的ETL管道创建CI/CD管道。您的目标应该是每当您对您的源代码控制库进行更改时，都在AWS中更新您的Python代码和基础结构。</li><li>向您的CI/CD管道添加一个“冒烟测试”,下载一个示例CSV文件，对其运行转换，并将其存储在数据库中，然后验证是否将正确的消息发布到SNS。找到一种不影响正常日常作业运行的“生产”数据的方法。</li><li>想办法创建一个实时更新的仪表板！</li></ol><p>请注意，如果您对更有趣的可视化有想法，欢迎调整建议的特定数据转换和数据字段。尽情发挥创造力吧！</p><h3 id="h-final-takeaways">最终外卖</h3><p>乍看之下，这一挑战似乎并不华丽。毕竟，它实际上只是从某个地方获取一些数据，将其与其他一些数据相结合，然后将其存储在其他地方。但是像这样的数据操作是云专业人员面临的一个非常常见的实际问题！以及所有这些棘手的情况——如果外部数据格式突然改变，会发生什么？—导致一些强大的复杂性。</p><p>熬过这一关，你就能在下一次求职面试中拿出一个精彩的故事。我保证你的招聘经理会开始想一两个他们自己的故事。</p><p>祝你好运！</p></div></div>    
</body>
</html>