<html>
<head>
<title>Cloud-based CI/CD on GCP | A Cloud Guru</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>GCP基于云的CI/CD |云专家</h1>
<blockquote>原文：<a href="https://acloudguru.com/blog/engineering/cloud-based-ci-cd-on-gcp#0001-01-01">https://acloudguru.com/blog/engineering/cloud-based-ci-cd-on-gcp#0001-01-01</a></blockquote><div><div class="elementor-widget-container"><p id="87d8">几年前，我和一个团队一起为一个AWS项目建立了一个生产<a href="https://acloudguru.com/course/implementing-a-full-ci-cd-pipeline"> CI/CD管道</a>。当时，没有一个主要的云供应商提供他们自己的CI/CD服务，所以我们使用了开源的<a href="https://www.gocd.org/" target="_blank" rel="noreferrer noopener"> GO CD服务器</a>。</p><p id="1d16">虽然我们成功了，但这个项目很乏味，花了几个月的时间。出于这个原因，我一直对尝试集成替代方案感兴趣。</p><p id="075e">最近，我的大部分生产工作都涉及到为生物信息学研究大规模构建和测试基于云的数据管道。我一直在思考如何最好地利用新的基于云的CI/CD服务来自动化这些复杂的管道部署。</p><h3 id="0469">描绘自动化部署</h3><p id="4c37">当我今天看完一篇写得很好的关于GCP CI/CD的教程时，我惊讶地发现我找不到任何关于这个过程的图表。虽然我成功地完成了教程，但我仍然觉得我没有完全理解解决方案架构应用程序。</p><div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" src="../Images/71a3c74c5441383efb2c1c07e119d27d.png" alt="" class="wp-image-41925" data-original-src="https://acg-wordpress-content-production.s3.us-west-2.amazonaws.com/app/uploads/2020/12/1_AOOTiW_rIY1McQzRWvWCHQ.png"/><figcaption>GCP cloud-native CI/CD Tutorial Steps</figcaption></figure></div><p>接下来，我试图画出我在教程中完成的自己的版本。从我的生产经验中快速勾画出考虑事项，并试图将它与我从完成教程中学到的东西结合起来，这并不令人满意。结果如下所示。</p><div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" src="../Images/d81fed9880c12b33d8b2079b0db9df2e.png" alt="" class="wp-image-41929" data-original-src="https://acg-wordpress-content-production.s3.us-west-2.amazonaws.com/app/uploads/2020/12/1_k63kIZ-oIVgHGzGU6MiP3Q.jpeg"/><figcaption>My initial thoughts around cloud-native CI/CD</figcaption></figure></div><p id="2ac0">对我来说，通过复杂的步骤找到一条清晰的路径还不是很明显。画完草图后，我试着思考构建这种管道所涉及的每个服务(T1)或服务(T3)的集合(T2)。</p><h3 id="2eb5">考虑GCP服务</h3><p id="4922">首先，我试图了解GCP工具服务产品，以及每项服务与为我的团队正在构建的数据管道类型构建CI/CD解决方案的关系。</p><p id="498a">有许多工具。以下是我对“工具”菜单上列出的每一项GCP服务的理解。请注意，所有这些服务都是无服务器的。</p><div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" src="../Images/e0ea66649a413cf13bb321574cf49318.png" alt="" class="wp-image-41928" data-original-src="https://acg-wordpress-content-production.s3.us-west-2.amazonaws.com/app/uploads/2020/12/1_H_-GOHn1U-dyk1u1xzCFIA.png"/><figcaption>GCP Tools</figcaption></figure></div><h3 id="b05f">了解更多信息</h3><p id="9d67">然后我看了一些最近的<a href="https://www.youtube.com/user/googlecloudplatform/playlists?view=50&amp;flow=grid&amp;shelf_id=26" target="_blank" rel="noreferrer noopener"> GCP:下一个</a>会议的演示。对我最有用的是以下内容:</p><ol><li>“<a href="https://www.youtube.com/watch?v=rt287-94Pq4" target="_blank" rel="noreferrer noopener">跨多个环境的CI CD很有趣，但展示了将非GCP工具(詹金斯、</a><a href="https://acloudguru.com/course/hashicorp-vault">哈希公司保险库</a> …)与GCP工具相结合，因此给潜在场景增加了更多复杂性。</li><li>“<a href="https://www.youtube.com/watch?v=TYx0BTyFtmc" target="_blank" rel="noreferrer noopener">通过云构建在K8上更快地开发</a>”—K8<a href="https://skaffold.dev/" target="_blank" rel="noreferrer noopener">ska ffold</a>库的引人注目的演示，但没有展示端到端场景。</li><li>"<a href="https://www.youtube.com/watch?v=yP9a5gDRUqY" target="_blank" rel="noreferrer noopener">使用GCP工具开发、部署&amp;调试</a> " —最有用的是演示如何使用各种服务的演示，例如非常智能的<a href="https://cloud.google.com/source-repositories/docs/searching-code" target="_blank" rel="noreferrer noopener">在源代码库中搜索</a>。</li></ol><p id="95cf">尽管这些演示和做教程有助于我理解如何为我的客户使用这些服务，但我仍然无法想象我实际上会构建什么。为此，我尝试为一个用例绘制一个可能的CI/CD架构，这个用例我已经工作了一段时间。</p><h3 id="5519">可视化GCP数据管道的CI/CD</h3><p id="c0d5">下面是我为我的一个客户设计解决方案的尝试。我将首先描述应用程序架构。用例是通过专门的基因组学机器学习库进行生物信息学研究，<a href="https://bioinformatics.csiro.au/variantspark" target="_blank" rel="noreferrer noopener"> VariantSpark </a>。</p><p id="f943">下图是GCP K8公司的解决方案架构:</p><div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" src="../Images/0899c571bf50d54ff580240ef449f0d7.png" alt="" class="wp-image-41930" data-original-src="https://acg-wordpress-content-production.s3.us-west-2.amazonaws.com/app/uploads/2020/12/1_uk1TdkDG-rlgokl1pTq9TA.png"/><figcaption>CSIRO’s VariantSpark on GCP K8</figcaption></figure></div><p id="a730">您会注意到这是一个数据湖，K8集群处理来自GCS的数据。托管Jupyter笔记本电脑是解决方案的一部分，因为这是研究工作的首选环境。</p><p id="a316">下面显示的是我的第一份草案，我想象我的团队如何使用GCP CI/CD服务来建立一个管道，以在GCP部署VariantSpark K8集群。</p><div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" src="../Images/edef0337fcbb64006c5d75bf05ebaded.png" alt="" class="wp-image-41926" data-original-src="https://acg-wordpress-content-production.s3.us-west-2.amazonaws.com/app/uploads/2020/12/1_feL2eY0ZEQwbG4Oya4XK-g.png"/><figcaption>GCP CI/CD Pipeline for VariantSpark K8 Deployment</figcaption></figure></div><p id="d88f">因为VariantSpark是开源库中的一员，所以它会不断得到改进。然而，因为VariantSpark是一个研究工具，所以它在发布时使用主版本号和次版本号，以便可以在可重复的生物信息学研究论文中引用。</p><p id="f1e7">因此构建集群的过程首先需要确定基本容器映像需要哪个版本的VariantSpark JAR文件。管道可能需要对VariantSpark的源GitHub Repo执行maven构建。</p><blockquote class="wp-block-quote"><p>云构建构件包括Docker映像、Kubernetes集群等等</p></blockquote><p id="8a2b">GCP <a href="https://cloud.google.com/source-repositories/docs/mirroring-a-github-repository" target="_blank" rel="noreferrer noopener">源代码库可以镜像GitHub Repos </a>。云构建可以使用源存储库上的触发器来触发构建。云构建包括各种类型映像的构建器(任务)，包括<a href="https://cloud.google.com/cloud-build/docs/cloud-builders" target="_blank" rel="noreferrer noopener"> maven </a>。云构建器还包括docker和kubectl，因此VariantSpark JAR文件可以作为docker映像的一部分构建，该映像可以用于生成一个<a href="https://acloudguru.com/course/google-kubernetes-engine-gke-beginner-to-pro"> GKE </a>集群。</p><p id="cb3e">此外，<a href="https://cloud.google.com/deployment-manager/docs/fundamentals">Google Deployment manager</a>可以服务于YAML部署，该部署详细描述了GKE集群所需的其他<a href="https://cloud.google.com/deployment-manager/docs/fundamentals"> GCP服务配置</a>。似乎也可以使用<a href="https://cloud.google.com/private-catalog/docs/overview" target="_blank" rel="noreferrer noopener"> GCP私人目录</a>为拥有GCP组织账户的研究小组提供VariantSpark GKE部署模板。</p><h3 id="b911">后续步骤</h3><p id="7ba3">现在我已经了解了这些服务的基础，我期待着与世界各地的研究和开发团队合作，为生物信息学建立无服务器CI/CD管道。</p><hr class="wp-block-separator is-style-dots"/><p>Lynn Langit是大数据和云架构师、谷歌云开发专家、AWS社区英雄和微软数据平台MVP。</p></div></div>    
</body>
</html>