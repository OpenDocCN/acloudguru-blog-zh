<html>
<head>
<title>Create an Instagram Post Clone with the AWS Amplify Admin UI, React, and Chakra UI | A Cloud Guru</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>使用AWS Amplify Admin UI、React和Chakra UI |云专家创建Instagram Post克隆</h1>
<blockquote>原文：<a href="https://acloudguru.com/blog/engineering/create-an-instagram-post-clone-with-the-aws-amplify-admin-ui-react-and-chakra-ui#0001-01-01">https://acloudguru.com/blog/engineering/create-an-instagram-post-clone-with-the-aws-amplify-admin-ui-react-and-chakra-ui#0001-01-01</a></blockquote><div><div class="elementor-widget-container"><h1 id="create-an-instagram-post-clone-with-the-aws-amplify-admin-ui-react-and-chakra-ui">什么是Amplify Admin UI？</h1><p>在本教程中，我们将使用<a href="https://sandbox.amplifyapp.com/getting-started"> AWS Amplify Admin UI </a>来创建Instagram卡克隆的后端。2020年在Re:Invent上发布的Amplify Admin UI <a href="https://acloudguru.com/blog/engineering/10-exciting-features-of-the-new-amplify-admin-ui">，它允许你使用可视化界面为应用程序创建数据。它还在您的数据模型之上创建了一个CMS，因此您不需要首先创建表单来创建一些示例数据，也不需要为内容仲裁者创建单独的管理应用程序。此外，它允许您在将数据模型部署到云之前对其进行测试——如果您愿意，甚至可以在没有AWS帐户的情况下进行测试！然后，只需点击几下鼠标，就可以部署到云中。</a></p><p>对于前端，我们将使用React和<a href="https://chakra-ui.com/"> Chakra UI </a>，这是一个非常棒的组件库，我们将使用它来使我们的应用程序看起来更好。</p><p>这是最终产品的图片:</p><figure class="wp-block-image size-large"><img loading="lazy" src="../Images/abcfcab05d904642f02f6ce9eea960c9.png" alt="" class="wp-image-47409" srcset="https://res.cloudinary.com/acloud-guru/image/fetch/c_thumb,f_auto,q_auto,w_1034/https://acg-wordpress-content-production.s3.us-west-2.amazonaws.com/app/uploads/2021/03/instacard-final.png 1034w, https://res.cloudinary.com/acloud-guru/image/fetch/c_thumb,f_auto,q_auto,w_210/https://acg-wordpress-content-production.s3.us-west-2.amazonaws.com/app/uploads/2021/03/instacard-final.png 210w, https://res.cloudinary.com/acloud-guru/image/fetch/c_thumb,f_auto,q_auto,w_718/https://acg-wordpress-content-production.s3.us-west-2.amazonaws.com/app/uploads/2021/03/instacard-final.png 718w, https://res.cloudinary.com/acloud-guru/image/fetch/c_thumb,f_auto,q_auto,w_768/https://acg-wordpress-content-production.s3.us-west-2.amazonaws.com/app/uploads/2021/03/instacard-final.png 768w" sizes="(max-width: 1034px) 100vw, 1034px" data-original-src="https://res.cloudinary.com/acloud-guru/image/fetch/c_thumb,f_auto,q_auto/https://acg-wordpress-content-production.s3.us-west-2.amazonaws.com/app/uploads/2021/03/instacard-final.png"/></figure><p>此外，如果你喜欢通过视频而不是书面教程学习，这里有这个项目的YouTube版本！</p><figure class="wp-block-embed is-type-rich is-provider-embed-handler wp-block-embed-embed-handler wp-embed-aspect-16-9 wp-has-aspect-ratio"><p class="wp-block-embed__wrapper">创建数据模型</p></figure><h2 id="create-the-data-model">首先，让我们为数据创建一个模式。您可以通过<a href="https://sandbox.amplifyapp.com/getting-started">此链接</a>访问管理用户界面。当我们这样做时，我们正在创建一个利用<a href="https://docs.amplify.aws/lib/datastore/getting-started/q/platform/js"> AWS Amplify DataStore </a>的后端。这将自动使您的数据同时在线和离线，这对移动开发人员来说尤其方便！</h2><p>在主页上，单击“创建应用后端”下的“开始”。</p><p>然后，在下一页选择“数据”和“空白模式”。</p><figure class="wp-block-image size-large"><img loading="lazy" src="../Images/ffff88d10a073e69b50a90e8c99ccfcb.png" alt="" class="wp-image-47411" srcset="https://res.cloudinary.com/acloud-guru/image/fetch/c_thumb,f_auto,q_auto,w_3572/https://acg-wordpress-content-production.s3.us-west-2.amazonaws.com/app/uploads/2021/03/homepage.png 3572w, https://res.cloudinary.com/acloud-guru/image/fetch/c_thumb,f_auto,q_auto,w_300/https://acg-wordpress-content-production.s3.us-west-2.amazonaws.com/app/uploads/2021/03/homepage.png 300w, https://res.cloudinary.com/acloud-guru/image/fetch/c_thumb,f_auto,q_auto,w_1024/https://acg-wordpress-content-production.s3.us-west-2.amazonaws.com/app/uploads/2021/03/homepage.png 1024w, https://res.cloudinary.com/acloud-guru/image/fetch/c_thumb,f_auto,q_auto,w_768/https://acg-wordpress-content-production.s3.us-west-2.amazonaws.com/app/uploads/2021/03/homepage.png 768w, https://res.cloudinary.com/acloud-guru/image/fetch/c_thumb,f_auto,q_auto,w_1536/https://acg-wordpress-content-production.s3.us-west-2.amazonaws.com/app/uploads/2021/03/homepage.png 1536w, https://res.cloudinary.com/acloud-guru/image/fetch/c_thumb,f_auto,q_auto,w_2048/https://acg-wordpress-content-production.s3.us-west-2.amazonaws.com/app/uploads/2021/03/homepage.png 2048w" sizes="(max-width: 3572px) 100vw, 3572px" data-original-src="https://res.cloudinary.com/acloud-guru/image/fetch/c_thumb,f_auto,q_auto/https://acg-wordpress-content-production.s3.us-west-2.amazonaws.com/app/uploads/2021/03/homepage.png"/></figure><p>点击“添加”按钮，然后点击“添加型号”。</p><figure class="wp-block-image size-large"><img loading="lazy" src="../Images/0d105b34840618029af4179de957a499.png" alt="" class="wp-image-47412" srcset="https://res.cloudinary.com/acloud-guru/image/fetch/c_thumb,f_auto,q_auto,w_3070/https://acg-wordpress-content-production.s3.us-west-2.amazonaws.com/app/uploads/2021/03/setup-data.png 3070w, https://res.cloudinary.com/acloud-guru/image/fetch/c_thumb,f_auto,q_auto,w_300/https://acg-wordpress-content-production.s3.us-west-2.amazonaws.com/app/uploads/2021/03/setup-data.png 300w, https://res.cloudinary.com/acloud-guru/image/fetch/c_thumb,f_auto,q_auto,w_1024/https://acg-wordpress-content-production.s3.us-west-2.amazonaws.com/app/uploads/2021/03/setup-data.png 1024w, https://res.cloudinary.com/acloud-guru/image/fetch/c_thumb,f_auto,q_auto,w_768/https://acg-wordpress-content-production.s3.us-west-2.amazonaws.com/app/uploads/2021/03/setup-data.png 768w, https://res.cloudinary.com/acloud-guru/image/fetch/c_thumb,f_auto,q_auto,w_1536/https://acg-wordpress-content-production.s3.us-west-2.amazonaws.com/app/uploads/2021/03/setup-data.png 1536w, https://res.cloudinary.com/acloud-guru/image/fetch/c_thumb,f_auto,q_auto,w_2048/https://acg-wordpress-content-production.s3.us-west-2.amazonaws.com/app/uploads/2021/03/setup-data.png 2048w" sizes="(max-width: 3070px) 100vw, 3070px" data-original-src="https://res.cloudinary.com/acloud-guru/image/fetch/c_thumb,f_auto,q_auto/https://acg-wordpress-content-production.s3.us-west-2.amazonaws.com/app/uploads/2021/03/setup-data.png"/></figure><p>我们将创建的第一个模型将是一个时间轴项目。这将有一个字符串形式的<code>description</code>和一个AWSDateTime形式的<code>postTime</code>。</p><figure class="wp-block-image size-large"><img loading="lazy" src="../Images/51d8cf9aa0627862961c72b8f5074145.png" alt="" class="wp-image-47413" srcset="https://res.cloudinary.com/acloud-guru/image/fetch/c_thumb,f_auto,q_auto,w_452/https://acg-wordpress-content-production.s3.us-west-2.amazonaws.com/app/uploads/2021/03/add-model.png 452w, https://res.cloudinary.com/acloud-guru/image/fetch/c_thumb,f_auto,q_auto,w_300/https://acg-wordpress-content-production.s3.us-west-2.amazonaws.com/app/uploads/2021/03/add-model.png 300w" sizes="(max-width: 452px) 100vw, 452px" data-original-src="https://res.cloudinary.com/acloud-guru/image/fetch/c_thumb,f_auto,q_auto/https://acg-wordpress-content-production.s3.us-west-2.amazonaws.com/app/uploads/2021/03/add-model.png"/></figure><p>这将与<code>content</code>有1:1的关系，所以每个<code>TimelineItem</code>将有一个关联的<code>Content</code>实例，它存储视频或图像的实际链接。</p><figure class="wp-block-image size-large"><img loading="lazy" src="../Images/7a06658ee2697a928f60d04a6e27f00a.png" alt="" class="wp-image-47414" srcset="https://res.cloudinary.com/acloud-guru/image/fetch/c_thumb,f_auto,q_auto,w_1016/https://acg-wordpress-content-production.s3.us-west-2.amazonaws.com/app/uploads/2021/03/timeline-item.png 1016w, https://res.cloudinary.com/acloud-guru/image/fetch/c_thumb,f_auto,q_auto,w_300/https://acg-wordpress-content-production.s3.us-west-2.amazonaws.com/app/uploads/2021/03/timeline-item.png 300w, https://res.cloudinary.com/acloud-guru/image/fetch/c_thumb,f_auto,q_auto,w_768/https://acg-wordpress-content-production.s3.us-west-2.amazonaws.com/app/uploads/2021/03/timeline-item.png 768w" sizes="(max-width: 1016px) 100vw, 1016px" data-original-src="https://res.cloudinary.com/acloud-guru/image/fetch/c_thumb,f_auto,q_auto/https://acg-wordpress-content-production.s3.us-west-2.amazonaws.com/app/uploads/2021/03/timeline-item.png"/></figure><p>在我们创建它之前，我们将创建一个<code>Enum</code>。这将有值<code>IMAGE</code>和<code>VIDEO</code>——我们将在<code>Content</code>上存储<code>TimelineItem</code>将呈现什么类型的内容。再次点击<code>add</code>按钮，但这次选择<code>Enum</code>。然后将两个可能的值相加！</p><p>现在，我们将创建我们的<code>Content</code>模型—再次点击<code>add</code>并选择<code>add model</code>。这个模型将有<code>source</code>，它是一个链接到图像或视频内容的字符串。然后会有一个<code>type</code>，这将是<code>ContentType</code>枚举-如果你滚动到底部，它应该会出现在下拉列表中！</p><figure class="wp-block-image size-large"><img loading="lazy" src="../Images/4e383283ff95917e5ec02e40dff534c5.png" alt="" class="wp-image-47415" srcset="https://res.cloudinary.com/acloud-guru/image/fetch/c_thumb,f_auto,q_auto,w_1296/https://acg-wordpress-content-production.s3.us-west-2.amazonaws.com/app/uploads/2021/03/content-type.png 1296w, https://res.cloudinary.com/acloud-guru/image/fetch/c_thumb,f_auto,q_auto,w_300/https://acg-wordpress-content-production.s3.us-west-2.amazonaws.com/app/uploads/2021/03/content-type.png 300w, https://res.cloudinary.com/acloud-guru/image/fetch/c_thumb,f_auto,q_auto,w_1024/https://acg-wordpress-content-production.s3.us-west-2.amazonaws.com/app/uploads/2021/03/content-type.png 1024w, https://res.cloudinary.com/acloud-guru/image/fetch/c_thumb,f_auto,q_auto,w_768/https://acg-wordpress-content-production.s3.us-west-2.amazonaws.com/app/uploads/2021/03/content-type.png 768w" sizes="(max-width: 1296px) 100vw, 1296px" data-original-src="https://res.cloudinary.com/acloud-guru/image/fetch/c_thumb,f_auto,q_auto/https://acg-wordpress-content-production.s3.us-west-2.amazonaws.com/app/uploads/2021/03/content-type.png"/></figure><p>现在，我们将在<code>TimelineItem</code>和<code>Content</code>之间创建一个关系。在<code>TimelineItem</code>下，点击【添加关系】。然后，选择<code>Content</code>型号，选择“一个TimelineItem对应一个内容”。您还可以更改关系名称——我通常将我的名称全部设置为小写。</p><figure class="wp-block-image size-large"><img loading="lazy" src="../Images/2c823a0bd1f019a9c450578caad141e7.png" alt="" class="wp-image-47416" srcset="https://res.cloudinary.com/acloud-guru/image/fetch/c_thumb,f_auto,q_auto,w_1294/https://acg-wordpress-content-production.s3.us-west-2.amazonaws.com/app/uploads/2021/03/content.png 1294w, https://res.cloudinary.com/acloud-guru/image/fetch/c_thumb,f_auto,q_auto,w_300/https://acg-wordpress-content-production.s3.us-west-2.amazonaws.com/app/uploads/2021/03/content.png 300w, https://res.cloudinary.com/acloud-guru/image/fetch/c_thumb,f_auto,q_auto,w_1024/https://acg-wordpress-content-production.s3.us-west-2.amazonaws.com/app/uploads/2021/03/content.png 1024w, https://res.cloudinary.com/acloud-guru/image/fetch/c_thumb,f_auto,q_auto,w_768/https://acg-wordpress-content-production.s3.us-west-2.amazonaws.com/app/uploads/2021/03/content.png 768w" sizes="(max-width: 1294px) 100vw, 1294px" data-original-src="https://res.cloudinary.com/acloud-guru/image/fetch/c_thumb,f_auto,q_auto/https://acg-wordpress-content-production.s3.us-west-2.amazonaws.com/app/uploads/2021/03/content.png"/></figure><p>现在，再添加两个模型。<code>Comment</code>和<code>User</code>。<code>Comment</code>会有一个主体，它是一个<code>String</code>，然后<code>User</code>会有一个<code>username</code>和一个<code>profilePic</code>，它们都是字符串。</p><figure class="wp-block-image size-large"><img loading="lazy" src="../Images/1f394219dba6d6239a61ea435d799209.png" alt="" class="wp-image-47417" srcset="https://res.cloudinary.com/acloud-guru/image/fetch/c_thumb,f_auto,q_auto,w_1642/https://acg-wordpress-content-production.s3.us-west-2.amazonaws.com/app/uploads/2021/03/add-relationship.png 1642w, https://res.cloudinary.com/acloud-guru/image/fetch/c_thumb,f_auto,q_auto,w_300/https://acg-wordpress-content-production.s3.us-west-2.amazonaws.com/app/uploads/2021/03/add-relationship.png 300w, https://res.cloudinary.com/acloud-guru/image/fetch/c_thumb,f_auto,q_auto,w_1024/https://acg-wordpress-content-production.s3.us-west-2.amazonaws.com/app/uploads/2021/03/add-relationship.png 1024w, https://res.cloudinary.com/acloud-guru/image/fetch/c_thumb,f_auto,q_auto,w_768/https://acg-wordpress-content-production.s3.us-west-2.amazonaws.com/app/uploads/2021/03/add-relationship.png 768w, https://res.cloudinary.com/acloud-guru/image/fetch/c_thumb,f_auto,q_auto,w_1536/https://acg-wordpress-content-production.s3.us-west-2.amazonaws.com/app/uploads/2021/03/add-relationship.png 1536w" sizes="(max-width: 1642px) 100vw, 1642px" data-original-src="https://res.cloudinary.com/acloud-guru/image/fetch/c_thumb,f_auto,q_auto/https://acg-wordpress-content-production.s3.us-west-2.amazonaws.com/app/uploads/2021/03/add-relationship.png"/></figure><p>在一个完整的生产应用程序中，您可能会添加一个从用户到您的身份验证提供者的用户的关系。</p><p>然后我们会添加关系。给<code>User</code>的<code>Comment</code>模型添加1:1关系，给<code>User</code>的<code>TimelineItem</code>模型添加1:1关系——我把这个名字改成了“作者”，然后把<code>TimelineItem</code>的1:n关系改成了<code>Comments</code>。</p><p>最终的模式应该如下所示:</p><p>部署您的应用</p><figure class="wp-block-image size-large"><img loading="lazy" src="../Images/87a8f37f9890bdba499d58240d1a1df2.png" alt="" class="wp-image-47418" srcset="https://res.cloudinary.com/acloud-guru/image/fetch/c_thumb,f_auto,q_auto,w_3430/https://acg-wordpress-content-production.s3.us-west-2.amazonaws.com/app/uploads/2021/03/finished-relationships.png 3430w, https://res.cloudinary.com/acloud-guru/image/fetch/c_thumb,f_auto,q_auto,w_300/https://acg-wordpress-content-production.s3.us-west-2.amazonaws.com/app/uploads/2021/03/finished-relationships.png 300w, https://res.cloudinary.com/acloud-guru/image/fetch/c_thumb,f_auto,q_auto,w_1024/https://acg-wordpress-content-production.s3.us-west-2.amazonaws.com/app/uploads/2021/03/finished-relationships.png 1024w, https://res.cloudinary.com/acloud-guru/image/fetch/c_thumb,f_auto,q_auto,w_768/https://acg-wordpress-content-production.s3.us-west-2.amazonaws.com/app/uploads/2021/03/finished-relationships.png 768w, https://res.cloudinary.com/acloud-guru/image/fetch/c_thumb,f_auto,q_auto,w_1536/https://acg-wordpress-content-production.s3.us-west-2.amazonaws.com/app/uploads/2021/03/finished-relationships.png 1536w, https://res.cloudinary.com/acloud-guru/image/fetch/c_thumb,f_auto,q_auto,w_2048/https://acg-wordpress-content-production.s3.us-west-2.amazonaws.com/app/uploads/2021/03/finished-relationships.png 2048w" sizes="(max-width: 3430px) 100vw, 3430px" data-original-src="https://res.cloudinary.com/acloud-guru/image/fetch/c_thumb,f_auto,q_auto/https://acg-wordpress-content-production.s3.us-west-2.amazonaws.com/app/uploads/2021/03/finished-relationships.png"/></figure><h2 id="deploy-your-app">现在，我们将开始部署我们的后端模式。如果你点击右上角的<code>test</code>链接，你会得到在本地测试你的模式的指示——这意味着你可以编写一个初始版本的后端，而不需要创建一个AWS帐户，也没有任何机会为任何事情付费。也就是说，对于本教程，我想直接跳到<code>deploy</code>选项卡，这样我们就可以获得CMS功能。</h2><p>转到<code>deploy</code>页面，在这里您将被指示创建一个AWS帐户或登录一个现有的帐户。</p><p>在下一页上，为您的应用程序选择一个名称，如“Instacard ”,然后选择一个AWS地区。部署你的应用需要几分钟时间。一旦完成，点击“后端环境”标签，然后“打开管理界面”。在此页面上，您将能够更新您部署的数据、添加身份验证和管理您的内容。</p><p>通过CMS添加数据</p><h2 id="add-data-via-the-cms">在管理用户界面中，转到<code>content</code>选项卡。您可以在这里为应用程序创建数据。为每个模型创建几个实例，并将数据连接在一起。我们将用它作为Instacard项目的测试数据！你可以从<code>TimelineItem</code>开始，然后创建你关联的<code>User</code>、<code>Content</code>和<code>Comments</code>。对于图片，使用你想要的任何地方的图片链接，我喜欢那些在<a href="https://unsplash.com/"> Unsplash </a>上的图片。</h2><p>创建React应用程序</p><figure class="wp-block-image size-large"><img loading="lazy" src="../Images/7369016953cd2ecad8836e94f69418b4.png" alt="" class="wp-image-47421" srcset="https://res.cloudinary.com/acloud-guru/image/fetch/c_thumb,f_auto,q_auto,w_1438/https://acg-wordpress-content-production.s3.us-west-2.amazonaws.com/app/uploads/2021/03/timeline-item-form.png 1438w, https://res.cloudinary.com/acloud-guru/image/fetch/c_thumb,f_auto,q_auto,w_300/https://acg-wordpress-content-production.s3.us-west-2.amazonaws.com/app/uploads/2021/03/timeline-item-form.png 300w, https://res.cloudinary.com/acloud-guru/image/fetch/c_thumb,f_auto,q_auto,w_1024/https://acg-wordpress-content-production.s3.us-west-2.amazonaws.com/app/uploads/2021/03/timeline-item-form.png 1024w, https://res.cloudinary.com/acloud-guru/image/fetch/c_thumb,f_auto,q_auto,w_768/https://acg-wordpress-content-production.s3.us-west-2.amazonaws.com/app/uploads/2021/03/timeline-item-form.png 768w" sizes="(max-width: 1438px) 100vw, 1438px" data-original-src="https://res.cloudinary.com/acloud-guru/image/fetch/c_thumb,f_auto,q_auto/https://acg-wordpress-content-production.s3.us-west-2.amazonaws.com/app/uploads/2021/03/timeline-item-form.png"/></figure><h2 id="create-a-react-app">现在我们的后端可以运行了！我们可以开始我们的前端工作。我们将首先创建一个React应用程序:</h2><p>一旦你完成了，就进入你的项目。我们需要为数据存储模型安装AWS Amplify JavaScript库和TypeScript，然后是Chakra UI及其所有依赖项。</p><pre class="wp-block-code"><code>$ npx create-react-app instacard
</code></pre><p>如果您没有安装Amplify CLI，请运行以下命令:</p><pre class="wp-block-code"><code>$ cd instacard
$ npm i aws-amplify typescript
$ npm i @chakra-ui/react @emotion/react@^11 @emotion/styled@^11 framer-motion@^4 @chakra-ui/icons
</code></pre><p>然后，我们需要运行<code>amplify pull</code>将你的应用程序放入本地项目。如果你回到管理界面，点击右上角的<code>local setup instructions</code>链接，你会得到一个命令。继续运行它。</p><pre class="wp-block-code"><code>$ curl -sL https://aws-amplify.github.io/amplify-cli/install | bash &amp;&amp; $SHELL
</code></pre><p>Amplify遵循类似Git的推/拉模型。如果您通过Admin UI创建变更，您也可以运行<code>amplify pull</code>在本地获取它们。如果您在本地进行更改，运行<code>amplify push</code>来部署这些更改。</p><pre class="wp-block-code"><code>$ amplify pull --appId your-app-id --envName staging
</code></pre><figure class="wp-block-image size-large"><img loading="lazy" src="../Images/083f4a4af44929f7a81f0a23ad9d86a3.png" alt="" class="wp-image-47420" srcset="https://res.cloudinary.com/acloud-guru/image/fetch/c_thumb,f_auto,q_auto,w_1476/https://acg-wordpress-content-production.s3.us-west-2.amazonaws.com/app/uploads/2021/03/local-setup.png 1476w, https://res.cloudinary.com/acloud-guru/image/fetch/c_thumb,f_auto,q_auto,w_300/https://acg-wordpress-content-production.s3.us-west-2.amazonaws.com/app/uploads/2021/03/local-setup.png 300w, https://res.cloudinary.com/acloud-guru/image/fetch/c_thumb,f_auto,q_auto,w_1024/https://acg-wordpress-content-production.s3.us-west-2.amazonaws.com/app/uploads/2021/03/local-setup.png 1024w, https://res.cloudinary.com/acloud-guru/image/fetch/c_thumb,f_auto,q_auto,w_768/https://acg-wordpress-content-production.s3.us-west-2.amazonaws.com/app/uploads/2021/03/local-setup.png 768w" sizes="(max-width: 1476px) 100vw, 1476px" data-original-src="https://res.cloudinary.com/acloud-guru/image/fetch/c_thumb,f_auto,q_auto/https://acg-wordpress-content-production.s3.us-west-2.amazonaws.com/app/uploads/2021/03/local-setup.png"/></figure><p>我们还需要为我们的项目配置Amplify。打开您的<code>src/index.js</code>文件并添加以下内容:</p><p>我们将创建三个主要的组件文件，让我们继续创建它们。</p><pre class="wp-block-code"><code>import Amplify from 'aws-amplify'
import awsconfig from './aws-exports'

Amplify.configure(awsconfig)
</code></pre><p>我们还将在根组件中设置<code>ChakraProvider</code>。</p><pre class="wp-block-code"><code>$ touch src/{Timeline.js,Card.js,CommentList.js}
</code></pre><p>创建时间轴组件</p><pre class="wp-block-code"><code>// App.js
import { ChakraProvider } from '@chakra-ui/react'

export default function App () {
  return (
    &lt;ChakraProvider&gt;
      &lt;div /&gt;
    &lt;/ChakraProvider&gt;
  )
}</code></pre><h2 id="create-the-timeline-component">我们要编写的第一个组件是时间轴组件。首先，我们将从数据存储中提取所有的<code>TimelineItem</code>。这看起来与React中初始渲染时的任何其他API调用非常相似，除了用<code>DataStore.query()</code>而不是<code>fetch</code>或<code>axios</code>调用。<code>DataStore.query()</code>将<code>TimelineItem</code>作为参数将从数据存储中获取所有的<code>TimelineItem</code>。</h2><p>现在，我们还将添加我们的UI代码，我们将从Chakra导入<code>Container</code>,这将使我们的内容在页面上居中。我们还将使用<a href="https://welearncode.com/use-children-react/"> React的子模式</a>来传递子元素。这个组件的直接子组件将是一个函数，所以我们将遍历每个<code>TimelineItem</code>并调用那个将呈现其他React组件的函数！</p><pre class="wp-block-code"><code>// Timeline.js
import { useState, useEffect } from 'react'
import { DataStore } from '@aws-amplify/datastore'

import { TimelineItem } from './models'

export function Timeline () {
  const [timeline, setTimeline] = useState([])

  useEffect(() =&gt; {
    const getTimeline = async () =&gt; {
      const timelineData = await DataStore.query(TimelineItem)
      setTimeline(timelineData)
    }

    getTimeline()
  }, [])

  return(
    &lt;div /&gt;
  )
}</code></pre><p>创建卡组件</p><pre class="wp-block-code"><code>// Timeline.js
import { useState, useEffect } from 'react'
import { DataStore } from '@aws-amplify/datastore'
+ import { Container } from '@chakra-ui/react'

import { TimelineItem } from './models'

+ export function Timeline ({ children }) {
  const [timeline, setTimeline] = useState([])

  useEffect(() =&gt; {
    const getTimeline = async () =&gt; {
      const timelineData = await DataStore.query(TimelineItem)
      setTimeline(timelineData)
    }

    getTimeline()
  }, [])

  return (
+    &lt;Container&gt;
+      {timeline.map(post =&gt; children({ post }))}
+    &lt;/Container&gt;
  )
}</code></pre><h2 id="create-the-card-component">现在，我们将创建一个卡组件。我将继续从Chakra导入我最终需要的所有东西，这样我就不需要再回到导入上来了。</h2><p>然后，我将创建我的起始组件。该组件将从一个呈现“Hello！”的框开始。它最终会接受子元素，但是让我们首先连接我们的<code>&lt;Timeline&gt;</code>组件，为每个<code>TimelineItem</code>呈现一个<code>&lt;Card /&gt;</code>。</p><pre class="wp-block-code"><code>// Card.js
import { Box, Image, Flex, Avatar, Text, Spacer, IconButton } from '@chakra-ui/react'
import { ChatIcon, AddIcon, EmailIcon } from '@chakra-ui/icons'
</code></pre><p>现在，我们将返回到我们的<code>&lt;App &gt;</code>组件并渲染我们的卡片时间轴！我需要导入必要的组件，然后在<code>&lt;Timeline&gt;</code>实例中，我们将添加一个返回<code>&lt;Card&gt;</code>实例的函数。时间轴中的<code>.map</code>将遍历所有的帖子，并运行这个函数为每个帖子渲染一个<code>&lt;Card&gt;</code>！</p><pre class="wp-block-code"><code>export function Card ({ children }) {
  return (
    &lt;Box maxW='lg' borderWidth='1px' borderRadius='md' overflow='hidden' m={5}&gt;
      &lt;h1&gt;Hello!&lt;/h1&gt;
    &lt;/Box&gt;
  )
}</code></pre><p>现在我们有了“你好！”每个<code>TimelineItem</code>都显示在一个框中，我们可以继续渲染实际的卡片数据。每个<code>&lt;Card&gt;</code>都有一个标题、一个主标题和一个页脚。这些都是组件，但是我们将创建它们并在<code>Card</code>组件下导出它们，因为我们将一前一后地使用它们。首先，让我们创建<code>&lt;Card.Header /&gt;</code>。这将需要考虑帖子的作者，所以我们将把它作为一个道具。然后，我们将渲染更多的脉轮盒和伸缩组件，以正确排列项目。我们还将使用Avatar组件来渲染图片(如果有的话)。在本教程中，我们实际上不会创建下拉菜单，所以我们只添加三个点作为占位符。</p><pre class="wp-block-code"><code>//App.js
import { ChakraProvider } from '@chakra-ui/react'

import { Timeline } from './Timeline'
import { Card } from './Card'

export default function App () {
  return (
    &lt;ChakraProvider&gt;
      &lt;Timeline&gt;
        {({ post }) =&gt; (
          &lt;Card key={post.id}&gt;&lt;/Card&gt;
        )}
      &lt;/Timeline&gt;
    &lt;/ChakraProvider&gt;
  )
}</code></pre><p>然后，我们将创建<code>&lt;Card.Main&gt;</code>组件，它将呈现文章包含的视频或图像。我们将为内容类型添加一个条件，然后呈现它。</p><pre class="wp-block-code"><code>// Card.js
Card.Header = function ({ author }) {
  return (
    &lt;Box p={2}&gt;
      &lt;Flex&gt;
        &lt;Box d='flex' alignItems='center'&gt;
          &lt;Avatar name={author.username} src={author.profilePic} /&gt;
          &lt;Box ml={2}&gt;
            &lt;Text fontWeight='bold' fontSize='sm'&gt;
              {author.username}
            &lt;/Text&gt;
          &lt;/Box&gt;
        &lt;/Box&gt;
        &lt;Spacer /&gt;
        &lt;Box p={2}&gt;
          &amp;hellip;
        &lt;/Box&gt;
      &lt;/Flex&gt;
    &lt;/Box&gt;
  )
}</code></pre><p>最后，卡片页脚将有三个按钮，在本教程中只是为了显示目的。然后，我们将在图片下面添加标题。我们还将为注释留出一个位置，这将是一个子组件。</p><pre class="wp-block-code"><code>Card.Main = function ({ content }) {
  let cardContent
  if (content.type === 'VIDEO') {
    cardContent = (
      &lt;video controls&gt;
        &lt;source src={content.source} /&gt;
      &lt;/video&gt;
    )
  } else {
    cardContent = &lt;Image src={content.source} /&gt;
  }
  return (
    &lt;Box&gt;
      {cardContent}
    &lt;/Box&gt;
  )
}</code></pre><p>现在，我们将创建最后一个组件，它将呈现所有的评论！这将类似于<code>Timeline</code>组件，但是我们只想查询属于该帖子的评论。因此，我们将根据评论所属的<code>post</code>的id来过滤评论。<code>DataStore.query()</code>接受可选的第二个参数，该参数指定查询的条件。</p><pre class="wp-block-code"><code>Card.Footer = function ({ author, description, children }) {
  return (
    &lt;Box ml={3}&gt;
      &lt;Box&gt;
        &lt;IconButton icon={&lt;AddIcon /&gt;} variant='ghost' /&gt;
        &lt;IconButton icon={&lt;ChatIcon /&gt;} variant='ghost' /&gt;
        &lt;IconButton icon={&lt;EmailIcon /&gt;} variant='ghost' /&gt;
      &lt;/Box&gt;
      &lt;Box mt={3}&gt;
        &lt;Text&gt;
          &lt;Text as='b'&gt;{author.username} &lt;/Text&gt;{description}
        &lt;/Text&gt;
      &lt;/Box&gt;
      &lt;Box&gt;
        {children}
      &lt;/Box&gt;
      &lt;Box mt={1} mb={2}&gt;
        &lt;Text fontSize='xs' color='gray.500'&gt;
          2 HOURS AGO
        &lt;/Text&gt;
      &lt;/Box&gt;
    &lt;/Box&gt;
  )
}</code></pre><p>现在，我们将返回到<code>&lt;App&gt;</code>组件来渲染卡片的所有这些部分！</p><pre class="wp-block-code"><code>import { useEffect, useState } from 'react'
import { DataStore } from '@aws-amplify/datastore'
import { Box, Text } from '@chakra-ui/react'

import { Comment } from './models'

export function CommentList ({ postId }) {
  const [comments, setComments] = useState([])
  useEffect(() =&gt; {
    const getComments = async () =&gt; {
      const postComments = await DataStore.query(Comment, p =&gt; p.timelineitemID === postId)
      setComments(postComments)
    }
    getComments()
  }, [])
  return (
    &lt;Box&gt;
      {comments.map(comment =&gt; (
        &lt;Text key={comment.id}&gt;
          &lt;Text key={comment.id}&gt;
            &lt;Text as='b'&gt;{comment.user.username} &lt;/Text&gt;
            {comment.body}
          &lt;/Text&gt;
        &lt;/Text&gt;
      ))}
    &lt;/Box&gt;
  )
}</code></pre><p>太神奇了！现在我们的Instacard完成了！</p><pre class="wp-block-code"><code>import { ChakraProvider } from '@chakra-ui/react'

import { Timeline } from './Timeline'
import { Card } from './Card'
import { CommentList } from './CommentList'
import { CommentForm } from './CommentForm'

export default function App () {
  return (
    &lt;ChakraProvider&gt;
      &lt;Timeline&gt;
        {({ post }) =&gt; (
          &lt;Card post={post} key={post.id}&gt;
            &lt;Card.Header author={post.author} /&gt;
            &lt;Card.Main content={post.content} /&gt;
            &lt;Card.Footer
              author={post.author}
              description={post.description}
            &gt;
              &lt;CommentList postId={post.id} /&gt;
            &lt;/Card.Footer&gt;
            &lt;CommentForm /&gt;
          &lt;/Card&gt;
        )}
      &lt;/Timeline&gt;
    &lt;/ChakraProvider&gt;
  )
}</code></pre><p>结论</p><h2 id="conclusion">概括地说，我们通过<a href="https://acloudguru.com/blog/engineering/10-exciting-features-of-the-new-amplify-admin-ui"> AWS Amplify Admin UI </a>为Instagram帖子创建了一个模式。然后，我们使用它的CMS为我们的应用程序创建内容，然后使用Chakra UI在React应用程序中显示时间线数据。AWS Amplify的管理用户界面支持快速后端开发，因此开发人员可以专注于他们的前端和业务逻辑。在本教程中，我们没有讨论身份验证或授权，但是您也可以通过可视化管理UI界面来启用它们。</h2><p>To recap, we created a schema for an Instagram post via the <a href="https://acloudguru.com/blog/engineering/10-exciting-features-of-the-new-amplify-admin-ui">AWS Amplify Admin UI</a>. Then we used its CMS to create content for our application and then displayed the timeline data in a React app using Chakra UI for styling. AWS Amplify’s Admin UI enables rapid backend development so that developers can focus on their frontend and business logic. We didn’t talk about authentication or authorization in this tutorial, but you can enable them via the visual Admin UI interface as well.</p></div></div>    
</body>
</html>