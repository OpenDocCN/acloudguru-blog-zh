<html>
<head>
<title>The Cron Daemon | A Cloud Guru</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>Cron守护进程|云专家</h1>
<blockquote>原文：<a href="https://acloudguru.com/blog/engineering/the-cron-daemon#0001-01-01">https://acloudguru.com/blog/engineering/the-cron-daemon#0001-01-01</a></blockquote><div><div class="elementor-widget-container"><h2 id="h-scheduling-recurring-tasks-on-linux-using-cron">使用Cron在Linux上调度周期性任务</h2><p>Cron是一个守护进程，用于调度你能想到的任何类型的任务。发送有关系统或程序统计数据的电子邮件、定期进行系统维护、制作备份或执行任何您能想到的任务都很有用。其他操作系统上也有类似的程序。在Mac OS X上，cron已经被另一个名为launchd的守护进程所取代。在Windows上，你有一个恰如其分的名字“任务调度程序”。如果你渴望Linux的GUI，基于Gnome的系统如Ubuntu，包括Gnome Schedule，它是cron的一个很好的前端。</p><h2 id="h-">Cron守护进程，Crond</h2><h2 id="h-the-cron-daemon-crond">cron守护进程使用crontab文件来指定运行什么任务以及何时运行。这些文本文件指定在特定时间间隔运行的命令。每个用户都可以拥有自己的crontab文件。还有系统范围的crontab文件，用于用户之间的协作或共享。cron守护进程将检查存储在var/spool/cron中的用户crontab文件，以及存储在<i>/etc/crontab</i>&amp;<i>/etc/cron . d</i>中的系统范围的crontab文件，它每分钟都会唤醒来执行此操作。</h2><p>Crontab</p><h2 id="h-crontab">Crontab是用于列出cron守护进程使用的表的命令。我们也将用于加载cron守护进程的文件称为crontab文件。当我们使用<em>crontab–e</em>命令时，我们正在编辑<em> /var/spool </em>中的crontab。这里的文件是不同的格式，不应该直接编辑。编辑crontab文件也称为创建Cron作业让我们从编辑我们自己的用户Crontab文件开始:<code>klack@:~$ crontab -e</code></h2><p>第一次尝试编辑crontab文件时，我们会被要求选择一个编辑器。Nano被认为是最简单的编辑器。继续，通过输入2选择nano。Crontab现在将创建crontab文件的临时副本，并在nano中打开它进行编辑。nano启动时，重复按Ctrl-V向下滚动到文件底部。您现在应该在新的一行上准备输入我们的第一个cron命令。</p><pre class="wp-block-preformatted">no crontab for klack - using an empty one&lt; Select an editor.  To change later, run 'select-editor'.1. /bin/ed&lt;2. /bin/nano        &lt;---- easiest4. /usr/bin/vim.tinyChoose 1-4 [2]: <code>2</code></pre><p>Crontab Format</p><h2 id="h-crontab-format">crontab文件中的每一行都可以是一个变量定义或cron命令。不要忘记按回车键，用换行符结束最后一个命令。你也可以用%结束最后一句话。这是导致命令失败的最常见错误，在这种情况下，不会显示错误。Cron命令有一个独特的模式，允许您指定自定义的重复时间。有五个字段用于指定运行的时间和命令。</h2><p>Crontab Examples</p><pre class="wp-block-preformatted">(Minute 0-59) (Hour 0-23) (Day of Month 1-31) (Month 1-12) (Day of week 0-7) (Command)</pre><h2 id="h-crontab-examples">这里有几个在不同时间间隔运行备份脚本的示例:<code>0 5 1 * * ~/backup-home.sh</code>我们在这里指定的是在每月的第一个<sup>日</sup>早上5:00运行backup-home.sh脚本。*表示通配符。在本例中，任务在一周中的所有月份和任何一天运行。<code>0 5 1,15 * * ~/backup-home.sh</code>在这个修改后的示例中，我们在月份字段中使用了一个逗号来表示我们希望这个任务在每月的1号<sup>1号</sup>和15号<sup>12号</sup>运行。<code>0 5 1 12/3 * ~/backup-home.sh</code>在本例中，12/3代表一个步长值。这意味着该命令将在每个季度的1号<sup>1号</sup>早上5点运行。<code>* 17-20 * * * ~/backup-home.sh</code>在这里，该备份脚本将在每天的17、18、19和20小时运行。<code>* * * * * ~/backup-home.sh</code>这个例子将每分钟运行一次。如果你认为你必须使用这个，请小心！<code>*/2 * * * * ~/backup-home.sh</code>结合这里的一些想法，这个命令包含一个步长值，每两分钟运行一次。这里我们使用了一个特殊的时间含义@reboot将在每次重启后运行一次。您还可以使用其他特殊的时间关键字。以下是完整列表:</h2><p>当你输入完预定的命令后，按下<strong> Ctrl-W </strong>和<strong> enter </strong>，将文件保存在nano中。然后按下<strong> Ctrl-X </strong>退出。Crontab现在将检查文件中的错误。如果没有发现错误，那么cron守护进程使用的表将被更新，更改将立即生效。</p><pre class="wp-block-preformatted">@reboot     :    Run once after reboot.@yearly     :    Run once a year@annually   :    Run once a year@monthly    :    Run once a month@weekly     :    Run once a week@daily      :    Run once a day@hourly     :    Run once an hour</pre><p>每小时一次，每天一次，每周一次，每月一次</p><h2 id="h-cron-hourly-cron-daily-cron-weekly-cron-monthly">为了方便使用cron作业，只需在/etc/中的这些目录中创建一个文件，任务将根据它所在的文件夹运行。然而，这样做让你对时间的控制更少(一周中的什么时候？肯定是某个时候)。</h2><p>克朗。允许和cron。否认</p><h2 id="h-cron-allow-and-cron-deny">这些文件可能位于/etc中，它们控制谁可以使用crontab命令。如果cron.allow存在，那么只有其中列出的用户(每行一个用户)可以运行crontab。如果cron.allow不存在，则任何用户都可以拥有crontab文件，cron.deny中列出的用户除外。如果这两个文件都不存在，则需要超级用户权限才能拥有用户crontab文件。</h2><p>系统范围的Crontab文件</p><h2 id="h-system-wide-crontab-files">在较大的用户环境中，编辑/etc/crontab或/etc/cron.d/中的文件可能更有好处。这些文件也由cron守护进程加载。在较大的用户环境中，协作用户可能希望在一个中心位置存储和查看所有crontab文件。/etc/crontab是一个单独的文件，它包含一个额外的字段，即用户字段。这个系统crontab条目将以root用户身份运行。可以在/etc/cron.d/目录中创建任何名称的文件。许多软件包使用这个目录，因为它提供了更好的组织。</h2><p>把一切都包起来</p><h2 id="h-wrapping-it-all-up">到目前为止，您应该能够通过脚本和cron守护进程(也称为cron作业)的组合来运行您能想到的任何任务。欢迎在下面的评论中留下任何问题。Linux Academy成员可以在此观看讲师指导视频<a href="https://linuxacademy.com/cp/lessons/lesson/course/2/lesson/6" target="_blank" rel="nofollow noopener noreferrer">。</a></h2><p>By now you should be able to run any task you can think of with the combination of scripts and the cron daemon (also called cron jobs).  Feel free to leave any questions in the comments below.  Linux Academy members can view instructor led video <a href="https://linuxacademy.com/cp/lessons/lesson/course/2/lesson/6" target="_blank" rel="nofollow noopener noreferrer">here</a>.</p></div></div>    
</body>
</html>