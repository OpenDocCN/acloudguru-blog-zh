<html>
<head>
<title>Docker COPY vs ADD: What’s the difference? | A Cloud Guru</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>Docker复制vs添加:有什么区别？|云专家</h1>
<blockquote>原文：<a href="https://acloudguru.com/blog/engineering/docker-copy-vs-add-whats-the-difference#0001-01-01">https://acloudguru.com/blog/engineering/docker-copy-vs-add-whats-the-difference#0001-01-01</a></blockquote><div><div class="elementor-widget-container"><p>如果您使用Docker文件构建容器映像，您很可能会遇到Docker指令ADD和COPY。添加和复制都提供了类似的功能，因为它们都允许您在构建时将文件夹和文件放入映像中。那么应该用哪一个呢？</p><p>在这篇文章中，我将讨论复制和添加之间的一些细微差别，并帮助您确定何时使用哪一种。</p><hr class="wp-block-separator" id="block-54e868af-ff0f-4e59-9487-1fd74fbbdd2a"/><p class="has-text-align-center" id="h-your-keys-to-a-better-career"><strong>通往更好职业的钥匙</strong></p><p class="has-text-align-center"><a href="https://acloudguru.com/pricing">立即开始ACG </a>通过AWS、Microsoft Azure、Google Cloud等领域的课程和实际动手实验室来改变你的职业生涯。</p><hr class="wp-block-separator" id="block-da0c2ec3-2040-4ea3-978a-a2c48f63678b"/><h2 id="h-what-is-the-docker-add-instruction">什么是Docker ADD指令？</h2><p>首先，我们来谈谈ADD指令。ADD指令一直是Docker的一部分。ADD使用两个参数:源和目标。</p><ul><li>source参数适用于所有类型的文件，并且与构建上下文相关。</li></ul><ul><li>目标参数可以是WORKDIR的绝对路径或相对路径。</li></ul><p>ADD还有其他一些它可以表演的“魔术”。ADD还支持从远程URL下载文件。除了远程文件支持，ADD还可以自动提取各种类型的档案到镜像中。如果您提供的源文件是用tar、gzip、bzip2或xz压缩的档案文件，ADD会自动将档案文件解压缩到所提供的目的地。应该注意的是，它通过内容来确定存档的类型，而不是简单地使用文件扩展名。</p><h2 id="h-what-is-the-docker-copy-instruction">什么是Docker复制指令？</h2><p>现在我们来看看复制说明。随着Docker版本1.0的发布，COPY作为一个指令被添加进来。像添加一样，复制也可以让您将文件和文件夹放入映像中。</p><p>它也有两个参数:源和目的地。</p><p>然而，COPY指令更加简单，并且没有ADD的一些额外特性。COPY不能与URL一起工作，而且它还按原样复制归档文件，而不是试图提取它们。</p><h2 id="h-why-do-add-and-copy-do-the-same-thing">为什么添加和复制做同样的事情？</h2><p>为什么两条不同的指令做同样的事情？</p><p>很久以前，有人指出ADD指令并不总是像预期的那样工作。也许您有一个想要复制但不想提取的tar存档文件。ADD会尝试提取它。此外，您可能有一个以无法识别的格式压缩的tar归档文件。您可以尝试使用ADD来提取它，但是因为它不被识别，所以ADD会将它复制为一个文件。</p><p>总的来说，大多数人认为ADD做得太多了。所以新的指令副本被添加到Docker中。ADD是作为一个指令保存的，以免破坏向后兼容性——此外，一些开发人员喜欢ADD提供的附加特性。</p><h2 id="h-when-should-you-use-add-and-when-should-you-use-copy">什么时候应该使用ADD，什么时候应该使用COPY？</h2><p>那么什么时候应该用ADD，什么时候应该用COPY呢？根据Docker最佳实践指南,你通常应该使用副本——但你的里程数可能会有所不同。</p><p>您可能想使用添加的远程网址功能或解压缩的档案。无意的添加而不是复制指令可能意味着功能映像和“损坏的”映像之间的差异。例如，您需要在映像中有一个tar归档文件作为归档文件。如果你不小心使用了ADD，你会得到存档的内容，而不是实际的图像。</p><p>关于ADD的远程URL特性，您最好使用RUN指令，并提供命令curl或wget来下载文件，然后在该命令之后使用tar或unzip(如果是归档文件)，或者您可能需要为您的映像运行的其他命令。这种方法产生较少的指令，并且较少的指令创建较小的图像。</p><p>有关添加和复制的更多信息，请务必查看官方的<a href="https://docs.docker.com/engine/reference/builder/"> Docker builder参考资料</a>。</p><h2>了解有关容器的更多信息</h2><p>想了解更多关于容器的知识吗？查看我们新的<a href="https://learn.acloud.guru/course/red-hat-certified-specialist-in-containers-and-kubernetes-exam/overview" target="_blank" rel="noreferrer noopener"> Red Hat容器认证专家和Kubernetes考试(EX180) </a>课程。它旨在帮助您获得通过EX180考试所需的知识和技能，并为您提供使用Red Hat OpenShift创建、管理和部署容器化解决方案的实践经验。</p><hr class="wp-block-separator"/><p class="has-text-align-center"><em>关注<a href="https://twitter.com/acloudguru" target="_blank" rel="noreferrer noopener"> Twitter </a>、<a href="https://www.facebook.com/acloudguru" target="_blank" rel="noreferrer noopener">脸书</a>、<a href="https://www.youtube.com/c/AcloudGuru/?sub_confirmation=1" target="_blank" rel="noreferrer noopener">订阅YouTube上的云专家</a>，或者加入我们的<a href="https://discord.com/invite/acloudguru" target="_blank" rel="noreferrer noopener"> Discord社区</a>的讨论，跟上所有的科技技能。看看这个月的<a href="https://acloudguru.com/blog/news/whats-free-at-acg" target="_blank" rel="noreferrer noopener">免费技术培训</a>的轮值名单！</em></p></div></div>    
</body>
</html>