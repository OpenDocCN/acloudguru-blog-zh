<html>
<head>
<title>AWS Lambda is winning, but first it had to die | A Cloud Guru</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>AWS Lambda赢了，但首先它得死|一个云专家</h1>
<blockquote>原文：<a href="https://acloudguru.com/blog/engineering/aws-lambda-is-winning-but-first-it-had-to-die#0001-01-01">https://acloudguru.com/blog/engineering/aws-lambda-is-winning-but-first-it-had-to-die#0001-01-01</a></blockquote><div><div class="elementor-widget-container"><p><em>主要特性的变化已经成功地将Lambda工作负载推向了主流，即使FaaS纯粹主义者感觉被背叛了</em></p><p>无服务器赢了吗？</p><p>如果你问AWS，他们会说<em>肯定是</em>。今年在亚马逊内部构建的所有新应用程序中，将近一半是运行在Lambda T3上的<a href="https://siliconangle.com/2020/11/30/exclusive-aws-chief-andy-jassy-wakeup-call-cloud-adoption/">。Andy Jassy在他的re:Invent keynote中花了一些时间来号召数千家现在在生产中运行Lambda工作负载的企业，但也许最有趣的是，今年新的无服务器功能发布升级到了Jassy的keynote-这通常是为今年最闪亮、最具战略意义的揭示保留的位置。至少AWS明确认为，无服务器现在是其云的主要卖点之一。</a></p><p>(另一方面，有一篇奇怪的文章<a href="https://thenewstack.io/adoption-of-aws-lambda-serverless-stalls/">，它花了大部分篇幅展示FaaS的增长，但却被冠以“无服务器采用停滞”的标题，因为……Kubernetes团队说他们没有使用同样多的Lambda？在其他新闻中，猫报告吃更少的蔬菜。)</a></p><p>没有争议的是，Lambda仍然是900磅重的FaaS大猩猩，今天看起来与2015年正式上市时有很大不同。早期购买无服务器系统的工程师总是对好的无服务器系统有<a href="https://twitter.com/PaulDJohnston/status/1336765475615879181">非常具体的想法</a>…最近，Lambda一直在质疑他们的假设。</p><h2 id="h-the-decline-and-fall-of-the-serverless-manifesto">无服务器宣言的衰亡</h2><p>FaaS纯度的那些最初的理想不是凭空出现的。就在2016年，AWS无服务器领导层还在谈论他们所谓的无服务器计算宣言。这是一个关于功能即服务应该如何运作的激进愿景。宣言出现在各种会谈中，包括T2在ACG的无服务器会议上。以下是它的主要原则:</p><p><em> <strong>《无服务器计算宣言》(约2016) </strong> </em></p><ul><li><em>功能是部署和扩展的单位</em></li><li><em>编程模型中没有可见的机器、虚拟机或容器</em></li><li><em>永久存储生活在别处</em></li><li><em>每个请求的规模；用户不能过度或不足配置容量</em></li><li><em>永远不要为闲置(无冷服务器/容器或其成本)付费</em></li><li><em>隐式容错，因为函数可以在任何地方运行</em></li></ul><p>这个宣言为如何构建和部署软件形成了一个令人震惊的和高度反文化的蓝图。它吸引了一个人数不多但充满活力的真正信徒群体，以及一群人数更多、声音更大的怀疑论者。</p><p>但是回过头来看，无服务器计算宣言很难超越那个小而忙碌的核心。大胆的愿景只是遗漏了太多现有的遗留工作负载和团队。</p><p>因此，渐渐地，就像奥威尔的<em>动物农场中的戒律一样，</em> AWS的无服务器计算的不可协商性开始改变。让我们浏览一下宣言的每一点，看看Lambda是否仍然坚持它。</p><p><strong>功能是部署和扩展的单位？</strong></p><p>算是吧，但不完全是。你可以部署多功能的Lambda层来管理大型二进制文件，或者(现在在预览版中)部署Lambda扩展来插入第三方代理，我被告知这些代理绝对不应该被认为是“Lambda的旁门左道”。查看这篇关于将flask应用程序迁移到AWS Lambda 的<a href="https://acloudguru.com/blog/engineering/adventures-in-migrating-to-serverless">教程！</a></p><p>编程模型中没有可见的机器、虚拟机或容器？</p><p><em>不再真实。</em>从2020年开始，Lambda <a href="https://acloudguru.com/blog/engineering/packaging-aws-lambda-functions-as-container-images">现在允许你自带容器</a>，而不仅仅是运送一个ZIP文件的代码。</p><p><strong>永久储存在别处的生命？</strong></p><p><em>未必。Lambda现在与EFS集成在一起，我猜从技术上来说是“在别处”,但并不比任何其他连接到服务器的NFS共享“在别处”更重要。它是安装在您计算机上的持久文件系统。</em></p><p><strong>每个请求的秤？</strong></p><p><em>是的！</em>既然Lambda可以运行容器，我相信请求模型现在是Lambda和AWS Fargate之类的托管容器服务之间最大的<a href="https://acloudguru.com/blog/engineering/serverless-is-eating-the-stack-and-people-are-freaking-out-and-they-should-be">概念差异。Lambda为每个并发请求提供了一个新的执行环境，而类似Fargate的服务仍然会在同一个(长期)容器上处理多个并发请求。</a></p><p><strong>用户不能过度配置或配置不足容量？</strong></p><p><em>不再真实。</em>满足供应的容量，这将您的冷启动问题转换为热成本问题。(我对此嗤之以鼻，但调配容量要比运行自己的Lambda预热工作好得多，很多人过去都是这样做的。)</p><p><strong>从不为闲置(没有冷服务器/容器或其成本)买单？</strong></p><p><em>不再正确—</em>无论如何，如果您使用调配的容量或EFS，情况就不会如此。</p><p><strong>隐式容错是因为函数可以在任何地方运行？</strong></p><p><em> Ehhhh。</em>这是关于抽象出可用性区域，除了Lambda(包括Fargate！)现在做。也就是说，我们开始听到更多来自AWS 的<a href="https://acloudguru.com/blog/engineering/why-serverless-with-aws-is-a-game-changer">指导，实际上，你需要考虑的错误领域是区域。没错:区域是新的可用性区域，正如我们所说的，精明的Lambda开发人员正在开发他们自己的(非常不受管理的)多区域架构。</a></p><p>为了加强这一趋势，让我们来看看Lambda的另外两个定义性的早期特性:</p><p><strong>有意的时空限制？</strong></p><p><em>越来越不真实</em>。功能磁盘大小、运行时间限制以及CPU和内存大小在过去5年中稳步增长。今天，你可以用10 GB的内存和6个vCPUs运行一个Lambda函数15分钟——这是一个足够大的计算量，足以让你认真考虑多线程、多用途函数和其他与FaaS的旧理想相悖的东西。</p><p><strong>零信任网络？</strong></p><p>如果你想要的话。在过去，Lambda架构严重偏向于IAM安全，而不是使用VPCs，这部分是出于意识形态的原因，但也因为将功能附加到自定义Eni会增加巨大的冷启动开销。今天，AWS的创新使得客户管理的VPC与Lambda更加兼容。</p><p>所以我们现在有一个更新的宣言，看起来像这样:</p><p><em> <strong>《无服务器计算宣言》(大约2020年)</strong> </em></p><ul><li><em> <s>功能是单位的调配和伸缩</s> </em></li><li><em> <s>编程模型中没有可见的机器、虚拟机或容器</s> </em></li><li><em> <s>永久储存在别处的生命</s> </em></li><li><em>每个请求的规模；</em> <em> <s>用户不能超量或欠配容量</s> </em></li><li><em> <s>【从不为闲置买单(没有冷服务器/容器或其成本)</s> </em></li><li><em> <s>隐式容错因为函数可以在任何地方运行</s> </em></li><li><em> <s>有意的时间和空间约束</s> </em></li><li><em> <s>零信任网络</s> </em></li></ul><p>我觉得自己就像巧克力工厂之旅结束时的威利·旺卡，环顾四周，看看孩子们都去了哪里。在所有这些意识形态原则中，那些沙上的线，<em>每请求缩放是唯一剩下的东西。</em></p><p>当然，您仍然可以根据最初的无服务器宣言来构建。但是这项服务并不要求你这样做。</p><p>如果你必须将Lambda的修正价值主张浓缩成一句格言，<em>动物农场- </em>风格，你会说什么？"<em>所有工作负载都得到管理，但有些工作负载比其他工作负载更容易管理？</em></p><h2 id="h-the-rise-of-serverless-for-everyone">无人服务器的兴起</h2><p>这似乎是澄清我最喜欢Lambda的补充的恰当时机。我认为它们是必要的，而且在许多情况下，是一种纯粹的好东西。</p><p>四年前我不会这么说。那时我更像是一个FaaS纯粹主义者。改变我想法的是多年来从工程团队那里听到的一种非常特殊的陈述，以不同的形式一遍又一遍地重复:</p><p><strong> <em>我喜欢使用Lambda，如果它……</em></strong><em/>【连接回我的本地VPC，足够大以运行我的工作负载，让我使用与我的其他系统相同的语言或开发工具，总是温暖的，支持某种形式的共享存储，等等】</p><p>我对这些陈述的第一反应是:如果你不能或者不愿意接受无状态、无容器、规模到零的函数，为什么还要使用Lambda呢？这就是Lambda的整个<em>点</em>。在我听来，这就像新的Stack调查中的那些Kubernetes猫，说他们真的很喜欢吃蔬菜，如果它们只含有更多的肉。</p><p>但我后来明白了，这句话真正有力的部分是开头部分。这是渴望的表现。</p><p><em>我很乐意使用Lambda，只要……</em></p><p>Lambda和一般的无服务器计算是什么激发了这么多人的这种反应？为什么一种全新的婴儿计算范式会在各地引发如此强烈的兴趣，从小型创业公司到大型传统企业？</p><p>因为与任何具体的技术细节相比，无服务器计算是一种理念。用一句简单的话来表达一个想法:拥有更少，建造更多。所有的无服务器主义，所有的技术指导都归结于这个目标。Lambda是一种令人向往的生活方式。</p><p>大约在2016年，Lambda大大领先于其时代，在某种程度上仍然如此。但是由于新特性的增加，包括容器支持，使得更多的构建者比以前更容易获得<em>拥有更少，构建更多</em>的身份。</p><p>AWS正在做的是，一个接一个地拿走<em>，如果只有</em> s <em>的话。</em>他们通过为需要的团队提供放心的选项(共享存储、调配容量)来消除对无服务器的本能异议。<em>我喜欢用Lambda！</em></p><h2 id="h-guiding-the-future">指引未来</h2><p>一些团队是否会出于困惑或惰性而使用这些特性，没有意识到他们可以构建一些更激进、更像宣言的东西？是的，我认为这是AWS可以提供更多帮助的领域。</p><p>看，Lambda控制台一团糟——你知道，我知道，AWS也知道。它比2001年的VCR有更多的附加功能蠕变和不连贯的UX路径。不管你怎么说基础设施即代码，控制台仍然是人们探索新服务的方式。这是他们如何形成他们想成为什么样的建设者的感觉。</p><p>控制台的重新设计是肯定需要的，但不仅仅是随意的翻新。我们需要一个支持原始宣言的Lambda特性的前景:代码级编程抽象、函数级部署。然后，当你挑战宣言的极限或你自己的组织约束时，仔细揭示渐进的复杂性。(有没有“回归复杂性”这种东西？因为那是当前的控制台。)</p><p>你想让建筑商在每次开始一个新项目时，面对更简单、更易于管理的选择。随着时间的推移，这改变了人们的看法。它不断地向他们呈现“无服务器方式”:嘿，我可以使用事件来构建它！我不需要把这个函数放在VPC里！违约很重要。我期待着看到AWS如何继续引导其客户走向成功。</p><p>与此同时，Lambda最终获得了认真的采用，最终取得了胜利，因为它摆脱了标志着其早期的FaaS纯粹主义——而没有损害其真正的价值支柱，即<em>拥有更少，建造更多的进步承诺。</em>无服务器计算宣言必须消亡，这样无服务器的承诺才能最终实现。</p></div></div>    
</body>
</html>