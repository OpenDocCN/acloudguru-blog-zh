<html>
<head>
<title>Create, debug, and deploy a serverless API with VS Code | A Cloud Guru</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>使用VS代码创建、调试和部署无服务器API云专家</h1>
<blockquote>原文：<a href="https://acloudguru.com/blog/engineering/create-debug-and-deploy-a-serverless-api-with-vs-code#0001-01-01">https://acloudguru.com/blog/engineering/create-debug-and-deploy-a-serverless-api-with-vs-code#0001-01-01</a></blockquote><div><div class="elementor-widget-container"><p>无服务器为开发者体验提供了一个强有力的转变。我们可以快速原型化和构建生产级软件，而不依赖于交付过程。这意味着我们可以更快地迭代，更快地获得反馈，等等。</p><p>在像微软Azure 这样的平台上，<a href="https://acloudguru.com/blog/engineering/qa-the-state-of-azure-serverless" target="_blank" rel="noreferrer noopener"> serverless令人兴奋的另一个原因是，你可以从Azure dashboard编写代码并立即部署。它显示了开发和生产之间的层次有多少。唯一要付出的代价是，以这种方式编写、测试和部署意味着您离开了您可能已经使用多年的编辑器。</a></p><h3 id="h-overview">概观</h3><p>在本文中，我将向您展示如何设置Visual Studio代码来编写、测试、调试和部署带有Azure函数的无服务器API。</p><p>更喜欢看而不是读？你可以跟随我在下面制作的视频。</p><figure class="wp-block-embed is-type-video is-provider-youtube wp-block-embed-youtube wp-embed-aspect-16-9 wp-has-aspect-ratio"><p class="wp-block-embed__wrapper"> </p></figure><p><em>注意:这是一本初级指南。要深入了解Azure函数的使用，请查看ACG的课程<a href="https://acloud.guru/overview/a9fa666c-dbce-450f-bbfb-c501a195ea88" target="_blank" rel="noreferrer noopener">使用Azure函数的无服务器计算</a>或<a href="https://docs.microsoft.com/en-us/learn/paths/create-serverless-applications/?WT.mc_id=startup-12350-chnwamba" target="_blank" rel="noreferrer noopener">微软关于创建无服务器应用的学习模块</a>。</em></p><h3 id="h-prerequisites"><strong>先决条件</strong></h3><p>要阅读本文，您需要以下内容:</p><ol type="1"><li>Azure账户:它是免费的，你不需要为无服务器的东西付费，除非你正在构建一个大规模的API</li><li><a href="https://djcb.link/ys/vscode" target="_blank" rel="noreferrer noopener"> VS代码</a>:永远免费</li><li><a href="https://nodejs.org" target="_blank" rel="noreferrer noopener">节点</a>:运行在计算机上的开源JS</li><li>npm:节点的程序包管理器—它随节点一起安装</li></ol><h3><strong>安装Azure功能工具</strong></h3><p>Azure Function Tools解释你的无服务器代码并构建它。当您试图运行或调试您的无服务器代码时，VS代码会寻找它。运行以下安装命令进行安装。</p><p>Mac:</p><pre class="wp-block-preformatted">brew tap azure/functions
brew install azure-functions-core-tools@3</pre><p>Windows、Linux和Mac:</p><pre class="wp-block-preformatted">npm i -g azure-functions-core-tools@3 --unsafe-perm true</pre><h3><strong>安装Azure函数VS代码扩展</strong></h3><p>安装了核心工具后，您现在可以安装VS代码扩展，它会为您完成所有无服务器的繁重工作。这个扩展将构建、运行甚至启动你的无服务器应用。它还可以使用各种模板为您搭建一个新的无服务器功能项目。</p><p>要安装它，从<a href="https://marketplace.visualstudio.com/items?itemName=ms-azuretools.vscode-azurefunctions?WT.mc_id=startup-12350-chnwamba" target="_blank" rel="noreferrer noopener">扩展页面</a>点击<strong>安装</strong>。</p><p>该扩展需要访问您的Azure帐户，然后才能部署您的无服务器代码。要设置它，请在安装扩展后单击出现在活动栏上的Azure徽标，然后单击<strong>登录Azure </strong>:</p><p>VS代码会打开你的默认浏览器，重定向到Azure的auth页面，在这里你可以登录并确认。只有拥有Azure帐户，您才能这样做。</p><h3><strong>创建新的功能项目</strong></h3><p>我们完成了所有的杂务，可以开始创建一个无服务器的函数项目了。</p><p>1.从活动栏中点击Azure，然后点击<strong>创建新项目</strong>图标:</p><p>2.选择要在其中创建该项目的文件夹。</p><p>3.VS代码会提示你选择一种语言来编写你的函数。在本文中，我将展示JavaScript中的所有例子，这样你也可以选择JavaScript。</p><p>4.我前面提到过，这个VS代码扩展允许您使用不同的模板创建无服务器函数。在您选择了一种语言之后，扩展将提示您选择您想要的启动模板。我们的例子是一个简单的HTTP API，所以选择<strong> HTTP trigger </strong>模板。</p><p>5.接下来，输入函数的名称。</p><figure class="wp-block-image size-large"><img loading="lazy" src="../Images/0930087f6a078eb1c0a01d34183be880.png" alt="" class="wp-image-45811" srcset="https://res.cloudinary.com/acloud-guru/image/fetch/c_thumb,f_auto,q_auto,w_1200/https://acg-wordpress-content-production.s3.us-west-2.amazonaws.com/app/uploads/2021/02/1nkBOlaw.png 1200w, https://res.cloudinary.com/acloud-guru/image/fetch/c_thumb,f_auto,q_auto,w_300/https://acg-wordpress-content-production.s3.us-west-2.amazonaws.com/app/uploads/2021/02/1nkBOlaw.png 300w, https://res.cloudinary.com/acloud-guru/image/fetch/c_thumb,f_auto,q_auto,w_1024/https://acg-wordpress-content-production.s3.us-west-2.amazonaws.com/app/uploads/2021/02/1nkBOlaw.png 1024w, https://res.cloudinary.com/acloud-guru/image/fetch/c_thumb,f_auto,q_auto,w_768/https://acg-wordpress-content-production.s3.us-west-2.amazonaws.com/app/uploads/2021/02/1nkBOlaw.png 768w" sizes="(max-width: 1200px) 100vw, 1200px" data-original-src="https://res.cloudinary.com/acloud-guru/image/fetch/c_thumb,f_auto,q_auto/https://acg-wordpress-content-production.s3.us-west-2.amazonaws.com/app/uploads/2021/02/1nkBOlaw.png"/></figure><p>6.最后，选择您希望该功能是受保护的还是公共的。选择匿名使其公开，我们可以这样做，因为我们并没有构建一个安全的API。</p><figure class="wp-block-image size-large"><img loading="lazy" src="../Images/643e6cf5dfbe178b0733c21531e266d9.png" alt="" class="wp-image-45812" srcset="https://res.cloudinary.com/acloud-guru/image/fetch/c_thumb,f_auto,q_auto,w_1202/https://acg-wordpress-content-production.s3.us-west-2.amazonaws.com/app/uploads/2021/02/Dz_s5KJc.png 1202w, https://res.cloudinary.com/acloud-guru/image/fetch/c_thumb,f_auto,q_auto,w_300/https://acg-wordpress-content-production.s3.us-west-2.amazonaws.com/app/uploads/2021/02/Dz_s5KJc.png 300w, https://res.cloudinary.com/acloud-guru/image/fetch/c_thumb,f_auto,q_auto,w_1024/https://acg-wordpress-content-production.s3.us-west-2.amazonaws.com/app/uploads/2021/02/Dz_s5KJc.png 1024w, https://res.cloudinary.com/acloud-guru/image/fetch/c_thumb,f_auto,q_auto,w_768/https://acg-wordpress-content-production.s3.us-west-2.amazonaws.com/app/uploads/2021/02/Dz_s5KJc.png 768w" sizes="(max-width: 1202px) 100vw, 1202px" data-original-src="https://res.cloudinary.com/acloud-guru/image/fetch/c_thumb,f_auto,q_auto/https://acg-wordpress-content-production.s3.us-west-2.amazonaws.com/app/uploads/2021/02/Dz_s5KJc.png"/></figure><p>VS代码将创建函数项目，并询问您是要在当前VS代码窗口中打开它，还是在新窗口中打开它。选择适合你的。</p><p>扩展创建了一个文件夹和几个文件。</p><pre class="wp-block-preformatted">. # Function project
 ├── hello_serverless # Single function. You can add more of this
 │   ├── function.json # Settings for only the hello_serverless function
 │   ├── index.js # Function logic
 ├── host.json # Global settings for all functions in this function project
 ├── local.settings.json # Environmental variables go here
 ├── package.json # Node dependencies and config go here
 └── proxies.json</pre><p>根目录是包含我们创建的函数的<code>hello_serverless</code>文件夹。该文件夹中的<code>index.js</code>文件是您的无服务器功能逻辑，您可以对其进行编辑，使其按照您想要的方式运行。值得注意的是，这是一个节点土地，所以安装依赖关系和所有的好东西是允许的。</p><h3><strong>运行您的功能</strong></h3><p>要运行该功能，点击活动栏中的<strong>调试</strong>按钮，然后点击<strong>播放</strong>按钮。</p><p>几秒钟后，您应该在终端中看到以下消息，确认运行成功，并且您的无服务器API现在正在端口7071上运行。</p><p>单击绿色的URL预览API。如果您想要自定义消息:<a href="http://localhost:7071/api/hello_serverless?name=Chris" target="_blank" rel="noreferrer noopener">http://localhost:7071/API/hello _ server less？名字=克里斯</a></p><h2><strong>调试您的函数</strong></h2><p>打开<code>index.js</code>文件，在您希望调试器暂停执行的任何地方添加一个断点:</p><figure class="wp-block-image size-large"><img loading="lazy" src="../Images/366de09203e33e124219ef62b5ee57d7.png" alt="" class="wp-image-45820" srcset="https://res.cloudinary.com/acloud-guru/image/fetch/c_thumb,f_auto,q_auto,w_1600/https://acg-wordpress-content-production.s3.us-west-2.amazonaws.com/app/uploads/2021/02/1zxvhUuA-1.png 1600w, https://res.cloudinary.com/acloud-guru/image/fetch/c_thumb,f_auto,q_auto,w_300/https://acg-wordpress-content-production.s3.us-west-2.amazonaws.com/app/uploads/2021/02/1zxvhUuA-1.png 300w, https://res.cloudinary.com/acloud-guru/image/fetch/c_thumb,f_auto,q_auto,w_1024/https://acg-wordpress-content-production.s3.us-west-2.amazonaws.com/app/uploads/2021/02/1zxvhUuA-1.png 1024w, https://res.cloudinary.com/acloud-guru/image/fetch/c_thumb,f_auto,q_auto,w_768/https://acg-wordpress-content-production.s3.us-west-2.amazonaws.com/app/uploads/2021/02/1zxvhUuA-1.png 768w, https://res.cloudinary.com/acloud-guru/image/fetch/c_thumb,f_auto,q_auto,w_1536/https://acg-wordpress-content-production.s3.us-west-2.amazonaws.com/app/uploads/2021/02/1zxvhUuA-1.png 1536w" sizes="(max-width: 1600px) 100vw, 1600px" data-original-src="https://res.cloudinary.com/acloud-guru/image/fetch/c_thumb,f_auto,q_auto/https://acg-wordpress-content-production.s3.us-west-2.amazonaws.com/app/uploads/2021/02/1zxvhUuA-1.png"/></figure><p>现在，通过单击播放按钮再次运行该功能。在浏览器中打开链接，一旦执行到达断点，浏览器将冻结，您可以返回VS代码查看暂停的执行。</p><h3><strong>部署到Azure </strong></h3><p>与创建和调试一样，部署也可以通过表单而不是代码来完成。要部署我们创建的功能项目，请遵循以下步骤:</p><ol type="1"><li>点击<strong>活动</strong>栏中的Azure按钮，点击<strong>部署到功能app </strong>按钮:</li></ol><ol type="1" start="2"><li>该扩展将列出您所有的Azure帐户订阅，并要求您选择一个。如果是新帐户，您应该获得默认订阅。无论如何，只需选择您有权部署的订阅即可</li></ol><ol type="1" start="3"><li>选择<strong> +在Azure中新建功能App</strong>:</li></ol><p>4.给函数起个名字。该名称必须是全球唯一的，这意味着没有其他Azure客户使用该名称。</p><p>5.选择节点14作为运行时。</p><ol type="1" start="6"><li>选择离你最近的地点。</li></ol><p>VS代码需要一两分钟在Azure上设置新功能并部署它。在部署过程中，您会在VS代码窗口的右下角看到状态更新。</p><p>部署完成后，单击View output按钮打开部署日志。</p><p>该日志包含关于您的部署的详细信息，还包含生产URL，您可以在其中预览您的功能。单击URL进行预览。</p><p>还可以在URL中添加名称查询，获得自定义问候语<a href="https://acloud-fn-demo.azurewebsites.net/api/hello_serverless?name=Chris" target="_blank" rel="noreferrer noopener">https://a cloud-fn-demo . azure websites . net/API/hello _ server less？name=Chris </a></p><h3><strong>添加另一个功能并部署</strong></h3><p>您可以通过从活动栏中单击Azure图标并单击<strong> Create function </strong>图标向您的函数项目添加更多函数。</p><p>您将被要求选择一个函数模板，并重复我们在<strong>创建一个新的函数项目</strong>中介绍的步骤。</p><p>当你创建了这个函数，你可以使用<strong>部署到Azure </strong>中的步骤进行重新部署。唯一不同的是，当提示选择功能时，不是选择<strong> +在Azure中创建新功能应用</strong>，<strong>选择您之前部署的功能</strong>。</p><h3><strong>结论</strong></h3><p>尝试使用npm install添加一个节点依赖项，并在index.js中导入该依赖项，看看是否可行。这篇关于<a href="https://code.visualstudio.com/docs/editor/debugging?WT.mc_id=startup-12350-chnwamba" target="_blank" rel="noreferrer noopener"> VS代码调试器</a>的文档将展示如何实现这一点。</p><h4 id="h-about-the-author">关于作者</h4><p>克里斯蒂安·恩万巴是微软的一名软件开发人员和高级开发人员。他编码、写作、教学、演讲和组织开发者活动。</p></div></div>    
</body>
</html>